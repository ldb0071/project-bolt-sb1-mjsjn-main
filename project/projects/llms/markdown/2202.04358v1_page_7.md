# Page 7

## Page Information

- **Type**: figure_page
- **Word Count**: 679
- **Has Tables**: True
- **Has Figures**: True

## Content

# Page 7

## Geographically Weighted Regression (GWR):

In the classic ordinary linear regression (OLR) model, dependent variable and independent variables can be expressed by the regression equation:

y i = β 0 + k ∑ k =1 β k x ik + glyph[epsilon1] i i = 1 , 2 , 3 . . .

where β 0 is regression constant; β 1 , . . . , β p are regression coefficients; glyph[epsilon1] i is the error term of the sample with the mean value zero and constant variance σ 2 .

Moreover, its coefficient can be estimated as:

̂ β = ( X T X ) -1 X T y

where

X =     1 x 11 x 12 · · · x 1 p 1 x 21 x 22 · · · x 2 p . . . . . . . . . . . . . . . 1 x n 1 x n 2 · · · x np     ,

y =     y 1 y 2 . . . y n     , ̂ β =     β 0 β 1 . . . β p    

In fact, the regression coefficient calculated by OLR model is the best unbiased estimation of all sample points, which can be regarded as the average relationship in the whole study area. The spatial variation of this relationship can be regarded as different fluctuations of the "average relationship" caused by spatial non-stationarity.

Based on the first law of geography, some scholars proposed a spatial weighted regression (GWR) model, trying to change the regression coefficient from global to local, and change the weight of adjacent points according to different distances in the regression framework. GWR model defines spatial non-stationarity as [10,35]:

y i = w 0 ( u i , v i ) × β 0 + p ∑ k =1 w k ( u i , v i ) × β k x ik + glyph[epsilon1] i

where β 0 ( u i , v i ) × β 0 ; β k ( u i , v i ) × β k . Therefore, we can regard w 0 ( u i , v i ) as the non-stationarity weight of the regression constant β 0 , and w k ( u i , v i ) represents the non-stationarity weight of regression coefficient β k . Substituting the estimated value of OLR ̂ β k into the above formula, the estimated value can be obtained as follows:

̂ y i = p ∑ k =0 ̂ β k ( u i , v i ) x ik

The estimator in matrix form can be expressed as:

̂ y i = x T i ( X T W ( u i , v i ) X ) -1 X T W ( u i , v i ) y

The Spatial weight matrix W ( u i , v i ) can be expressed as:

W ( u i , v i ) glyph[defines]     w 1 ( u i , v i ) 0 · · · 0 0 w 2 ( u i , v i ) · · · 0 . . . . . . . . . . . . 0 0 · · · w n ( u i , v i )    

In GWR model, the weight kernels usually use Gaussian, bi-square, tri-cube and exponential functions. These functions can relatively simply express the complex relationship between spatial proximity (i.e. spatial distance) and spatial non-stationarity (i.e. spatial weight).

It should be noted that there are different ways to select the function in the spatial weight matrix. Different selection methods directly affect the final modeling accuracy.

The Gaussian weighted function can be expressed as:

w ij = e -d s ij b 2

where d s ij is the distance between points i and j; b, the bandwidth, producing a declining effect relative to d s ij , has different methods to select: for the fixed Gaussian weight function, the bandwidth is the same at each point and is a constant in the same model; for the adaptive Gaussian weight function, the bandwidth is different at each point, and the point distance closest to the point is often taken as the value of bandwidth. In any case, the Gaussian weight function requires a variable input, that is, the distance range (fixed bandwidth) or the number of major adjacent features (dynamic bandwidth).

The bi-square weighted function can be expressed as:

w ij = { [1 -( d s ij /b i ) 2 ] 2 , d s ij < b i ; 0 , the others .

where d s ij is the distance between two points; b i is the bandwidth. It is also divided into fixed type and adaptive type according to the above method.

This model is built using adaptive functions, i.e., an input variable is needed to select the number of major neighboring elements, and the AICc criterion is used to determine whether it is more preferable. [11]

Geographically Neural Network Weighted Regression (GNNWR): Similarly, based on the nonstationarity in the spatial relationship, GNNWR goes further than GWR, trying to further accurately describe the fluctuation level of spatial non-stationarity on the regression relationship at different locations. The key step of GWR is the selection and construction of spatial weight matrix function. On this basis, GNNWR attempts to go further and find an appropriate spatial weight matrix function with the help of neural network.

To accurately fit the complex relationship between spatial distance and spatial weight, GNNWR designs a spatial weighted neural network (SWNN) to achieve the neural network expression of weight kernel function. Specifically, SWNN takes the spatial distance between points as the input layer and the spatial weight matrix as the output layer, and selects the appropriate number of hidden layers according to the modeling needs. The spatial weight calculation of the points corresponds with:

̂ y i = x T i ̂ β ( u i , v i ) = x T i W ( u i , v i )( X T X ) -1 X T y

where W ( u i , v i ) is the spatial weight matrix as:

W ( u i , v i ) glyph[defines]     w 0 ( u i , v i ) 0 · · · 0 0 w 1 ( u i , v i ) · · · 0 . . . . . . . . . . . . 0 0 · · · w p ( u i , v i )    

That is, this matrix is the result of function W : R 2 → R (1+ p ) × (1+ p ) . SWNN further considers the existence of an intermediate variable [ d i 1 , d i 2 , d i 3 , · · · , d in ] and matric W ( u i , v i ) is a function of variable [ d i 1 , d i 2 , d i 3 , · · · , d in ] , where d ij is the distance from point i to sample point j. Thus, the GNNWR-based house price estimation model is shown as Figure 3:

## Visual Content

### Page Preview

![Page 7](/projects/llms/images/2202.04358v1_page_7.png)

### Figures

![](/projects/llms/figures/2202.04358v1_page_7_figure_1.png)


## Tables

### Table 1

| Structure of
Hidden Layers | Validation
Loss | Train
Loss | Test
Loss |
| --- | --- | --- | --- |
| [1024, 512, 256,
128, 64, 32] | 0.006470 | 0.002790 | 0.008867 |
| [512, 128, 64, 16] | 0.006427 | 0.0038040 | 0.008661 |
| [512, 128, 32] | 0.006529 | 0.0040193 | 0.008683 |
| [256, 64, 16] | 0.006537 | 0.0043795 | 0.008555 |
| [256, 32, 8] | 0.006527 | 0.0049904 | 0.008379 |
| [256, 32] | 0.006567 | 0.0046721 | 0.008992 |
