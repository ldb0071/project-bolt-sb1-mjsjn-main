# Page 10

## Page Information

- **Type**: main_content
- **Word Count**: 240
- **Has Tables**: False
- **Has Figures**: False

## Content

# Page 10

## 4 EXPERIMENTS

We extensively evaluate Anomaly Transformer on six benchmarks for three practical applications.

Datasets Here is a description of the six experiment datasets: (1) SMD (Server Machine Dataset, Su et al. (2019)) is a 5-week-long dataset that is collected from a large Internet company with 38 dimensions. (2) PSM (Pooled Server Metrics, Abdulaal et al. (2021)) is collected internally from multiple application server nodes at eBay with 26 dimensions. (3) Both MSL (Mars Science Laboratory rover) and SMAP (Soil Moisture Active Passive satellite) are public datasets from NASA (Hundman et al., 2018) with 55 and 25 dimensions respectively, which contain the telemetry anomaly data derived from the Incident Surprise Anomaly (ISA) reports of spacecraft monitoring systems. (4) SWaT (Secure Water Treatment, Mathur & Tippenhauer (2016)) is obtained from 51 sensors of the critical infrastructure system under continuous operations. (5) NeurIPS-TS (NeurIPS 2021 Time Series Benchmark) is a dataset proposed by Lai et al. (2021) and includes five time series anomaly scenarios categorized by behavior-driven taxonomy as point-global, pattern-contextual, pattern-shapelet, pattern-seasonal and pattern-trend. The statistical details are summarized in Table 13 of Appendix.

Implementation details Following the well-established protocol in Shen et al. (2020), we adopt a non-overlapped sliding window to obtain a set of sub-series. The sliding window is with a fixed size of 100 for all datasets. We label the time points as anomalies if their anomaly scores (Equation 6) are larger than a certain threshold δ . The threshold δ is determined to make r proportion data of the validation dataset labeled as anomalies. For the main results, we set r = 0 . 1% for SWaT, 0.5% for SMD and 1% for other datasets. We adopt the widely-used adjustment strategy (Xu et al., 2018; Su et al., 2019; Shen et al., 2020): if a time point in a certain successive abnormal segment is detected, all anomalies in this abnormal segment are viewed to be correctly detected. This strategy is justified from the observation that an abnormal time point will cause an alert and further make the whole segment noticed in real-world applications. Anomaly Transformer contains 3 layers. We set the channel number of hidden states d model as 512 and the number of heads h as 8. The hyperparameter λ (Equation 4) is set as 3 for all datasets to trade-off two parts of the loss function. We use the ADAM (Kingma & Ba, 2015) optimizer with an initial learning rate of 10 -4 . The training process is early stopped within 10 epochs with the batch size of 32. All the experiments are implemented in Pytorch (Paszke et al., 2019) with a single NVIDIA TITAN RTX 24GB GPU.

Baselines We extensively compare our model with 18 baselines, including the reconstructionbased models: InterFusion (2021), BeatGAN (2019), OmniAnomaly (2019), LSTM-VAE (2018); the density-estimation models: DAGMM (2018), MPPCACD (2017), LOF (2000); the clusteringbased methods: ITAD (2020), THOC (2020), Deep-SVDD (2018); the autoregression-based models: CL-MPPCA (2019), LSTM (2018), VAR (1976); the classic methods: OC-SVM (2004), IsolationForest (2008). Another 3 baselines from change point detection and time series segmentation are deferred to Appendix I. InterFusion (2021) and THOC (2020) are the state-of-the-art deep models.

Figure 3: ROC curves (horizontal-axis: false-positive rate; vertical-axis: true-positive rate) for five corresponding datasets. A higher AUC value (area under the ROC curve) indicates a better performance. The predefined threshold proportion r is in { 0 . 5% , 1 . 0% , 1 . 5% , 2 . 0% , 10% , 20% , 30% } .

<!-- image -->

Table 1: Quantitative results for Anomaly Transformer ( Ours ) in five real-world datasets. The P , R and F1 represent the precision, recall and F1-score (as % ) respectively. F1-score is the harmonic mean of precision and recall. For these three metrics, a higher value indicates a better performance.

| Dataset                                                                                                   | SMD         | MSL                                                                                       | SMAP              | SWaT        | PSM                                                                                       | PSM   | PSM   |    |    |    |
|-----------------------------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------------------|-------------------|-------------|-------------------------------------------------------------------------------------------|-------|-------|----|----|----|
| Metric F1 R F1                                                                                            | P R         | P R F1 F1 R                                                                               | P                 | P R         | P                                                                                         | F1    |       |    |    |    |
| OCSVM                                                                                                     |             | 44.34 76.72 56.19 59.78 86.87 70.82 53.85 59.07 56.34 45.39 49.22 47.23 62.75 80.89 70.67 |                   |             |                                                                                           |       |       |    |    |    |
| IsolationForest 42.31 73.29 53.64 53.94 86.54 66.45 52.39 59.07 55.53 49.29 44.95 47.02 76.09 92.45 83.48 |             |                                                                                           |                   |             |                                                                                           |       |       |    |    |    |
| LOF                                                                                                       |             | 56.34 39.86 46.68 47.72 85.25 61.18 58.93 56.33 57.60 72.15 65.43 68.62 57.89 90.49 70.61 |                   |             |                                                                                           |       |       |    |    |    |
| Deep-SVDD                                                                                                 |             |                                                                                           |                   |             | 78.54 79.67 79.10 91.92 76.63 83.58 89.93 56.02 69.04 80.42 84.45 82.39 95.41 86.49 90.73 |       |       |    |    |    |
| DAGMM                                                                                                     |             | 67.30 49.89 57.30 89.60 63.93 74.62 86.45 56.73 68.51 89.92 57.84 70.40 93.49 70.03 80.08 |                   |             |                                                                                           |       |       |    |    |    |
| MMPCACD 71.20 79.28 75.02 81.42 61.31 69.95 88.61 75.84 81.73 82.52 68.29 74.73 76.26 78.35 77.29         |             |                                                                                           |                   |             |                                                                                           |       |       |    |    |    |
| VAR                                                                                                       |             | 78.35 70.26 74.08 74.68 81.42 77.90 81.38 53.88 64.83 81.59 60.29 69.34 90.71 83.82 87.13 |                   |             |                                                                                           |       |       |    |    |    |
| LSTM                                                                                                      |             | 78.55 85.28 81.78 85.45 82.50 83.95 89.41 78.13 83.39 86.15 83.27 84.69 76.93 89.64 82.80 |                   |             |                                                                                           |       |       |    |    |    |
| CL-MPPCA                                                                                                  |             |                                                                                           |                   |             | 82.36 76.07 79.09 73.71 88.54 80.44 86.13 63.16 72.88 76.78 81.50 79.07 56.02 99.93 71.80 |       |       |    |    |    |
| ITAD                                                                                                      |             | 86.22 73.71 79.48 69.44 84.09 76.07 82.42 66.89 73.85 63.13 52.08 57.08 72.80 64.02 68.13 |                   |             |                                                                                           |       |       |    |    |    |
| LSTM-VAE                                                                                                  |             | 75.76 90.08 82.30 85.49 79.94 82.62 92.20 67.75 78.10 76.00 89.50 82.20 73.62 89.92 80.96 |                   |             |                                                                                           |       |       |    |    |    |
| BeatGAN                                                                                                   |             |                                                                                           |                   |             | 72.90 84.09 78.10 89.75 85.42 87.53 92.38 55.85 69.61 64.01 87.46 73.92 90.30 93.84 92.04 |       |       |    |    |    |
| OmniAnomaly 83.68 86.82 85.22 89.02 86.37 87.67 92.49 81.99 86.92 81.42 84.30 82.83 88.39 74.46 80.83     |             |                                                                                           |                   |             |                                                                                           |       |       |    |    |    |
| InterFusion                                                                                               |             | 87.02 85.43 86.22 81.28 92.70 86.62 89.77 88.52 89.14 80.59 85.58 83.01 83.61 83.45 83.52 |                   |             |                                                                                           |       |       |    |    |    |
| THOC                                                                                                      |             | 79.76 90.95 84.99 88.45 90.97 89.69 92.06 89.34 90.68 83.94 86.36 85.13 88.14 90.99 89.54 |                   |             |                                                                                           |       |       |    |    |    |
| Ours 92.33                                                                                                | 89.40 95.45 | 92.09 95.15 96.69 94.07                                                                   | 93.59 94.13 99.40 | 91.55 96.73 | 96.91 98.90                                                                               | 97.89 |       |    |    |    |

## Visual Content

### Page Preview

![Page 10](/projects/llms/images/2110.02642v5_page_10.png)
