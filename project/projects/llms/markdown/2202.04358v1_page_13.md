# Page 13

## Page Information

- **Type**: figure_page
- **Word Count**: 159
- **Has Tables**: False
- **Has Figures**: True

## Content

# Page 13

## 3.3 Spatial Non-stationarity Diagnosis of House Price Regression Relationship

Based on the spatial heterogeneity diagnostic indicators discussed above, the results based on GNNWR can be analyzed in two parts.

First, it is possible to identify whether the model results have a relatively significant spatial nonsmoothness. In the ten-fold data, the prediction effect parameters of each GNNWR model in the validation set are as Table 7.

Using RMSE as the index, the best fitting model (model 4) and the worst fitting model (model 3) were selected for hypothesis testing. The hypothesis testing parameters were calculated from the previous derivation as the following Table 8.

Following F 1 value, we can deduce the p value so that the hypothesis establishes by calculating the F distribution. It is notably that the hypothesis is rejected and it is significant that there is severe spatial non-stationarity when modeling Shenzhen house price.

Next, we could analyze the significance for each independent variable. To every independent variable, the null hypothesis is that the coefficient of this variable is a constant. It is to be noted that this hypothesis includes another hypothesis which assumes the coefficient of this variable is 0 everywhere. Therefore, the p value of F 2 can reject both of the hypotheses if it is tiny enough. All of the details are shown in the Table 9.

Evidently, every independent variable has signifi-

Table 5: Indicators of GWR and GNNWR on Train Sets

| Train Set   | Model    |     R2 |    RMSE |     MAE |     MAPE |   Pearson Cor. Coe. |    AICc |
|-------------|----------|--------|---------|---------|----------|---------------------|---------|
| 0           | GNNWR    | 0.913  | 6665.74 | 4907.16 | 0.084455 |            0.95589  | 44935.9 |
| 0           | GWR(108) | 0.8806 | 7810.28 | 5722.9  | 0.096476 |            0.938932 | 46711.9 |
| 1           | GNNWR    | 0.9145 | 6698.92 | 4945.16 | 0.084418 |            0.95629  | 44923.2 |
|             | GWR(101) | 0.8881 | 7662.4  | 5624.61 | 0.095042 |            0.942811 | 46714.4 |
| 2           | GNNWR    | 0.9168 | 6516.65 | 4849.38 | 0.084081 |            0.957767 | 44799.7 |
| 2           | GWR(101) | 0.8835 | 7713.28 | 5663.39 | 0.095898 |            0.940476 | 46751.7 |
| 3           | GNNWR    | 0.9068 | 6923.85 | 5118.84 | 0.087057 |            0.952315 | 45066.7 |
| 3           | GWR(101) | 0.8887 | 7566.31 | 5594.39 | 0.09418  |            0.943155 | 46666.6 |
| 4           | GNNWR    | 0.918  | 6489.22 | 4784.29 | 0.080781 |            0.958206 | 44776.1 |
| 4           | GWR(101) | 0.8842 | 7711.99 | 5656.98 | 0.09541  |            0.94083  | 46748.3 |
| 5           | GNNWR    | 0.9109 | 6777.58 | 4990.82 | 0.086299 |            0.954517 | 44972.4 |
| 5           | GWR(101) | 0.8849 | 7702.18 | 5664.53 | 0.095798 |            0.94122  | 46744.8 |
| 6           | GNNWR    | 0.9175 | 6538.53 | 4796.9  | 0.082787 |            0.958058 | 44850.1 |
| 6           | GWR(106) | 0.8814 | 7839.84 | 5715.71 | 0.096394 |            0.939293 | 46752   |
| 7           | GNNWR    | 0.9183 | 6529.28 | 4827.74 | 0.081521 |            0.958488 | 44795.1 |
| 7           | GWR(101) | 0.8871 | 7675.5  | 5658.68 | 0.095299 |            0.942348 | 46730.6 |
| 8           | GNNWR    | 0.9077 | 6868.49 | 5104.66 | 0.087495 |            0.953352 | 45038.1 |
| 8           | GWR(104) | 0.8825 | 7749.99 | 5713.72 | 0.096287 |            0.939906 | 46735.5 |
| 9           | GNNWR    | 0.9082 | 6814.82 | 4998.5  | 0.086338 |            0.953331 | 45025.8 |
| 9           | GWR(107) | 0.8796 | 7802.49 | 5714.57 | 0.096653 |            0.938439 | 46719.3 |

Table 6: Indicators of GWR and GNNWR on Test Sets

| Test Set   |       R2 |    RMSE |     MAE |     MAPE |   Mean Err. |   Pearson Cor. Coe. |
|------------|----------|---------|---------|----------|-------------|---------------------|
| GWR        | 0.790389 | 11195   | 7912.01 | 0.122266 |     911.384 |            0.891319 |
| GNNWR      | 0.817178 | 10455.2 | 7108.72 | 0.109174 |    1393.69  |            0.905834 |

Table 7: Prediction Performace of 10 GNNWR Models on Each Validation Set

|   Validation Set |       R2 |    RMSE |     MAE |     MAPE |   Pearson Cor. Coe. |
|------------------|----------|---------|---------|----------|---------------------|
|                0 | 0.836963 | 9454.35 | 6876.56 | 0.11583  |            0.915256 |
|                1 | 0.82143  | 8697.79 | 6277.03 | 0.105508 |            0.907206 |
|                2 | 0.855282 | 8930.44 | 6546.94 | 0.10976  |            0.924835 |
|                3 | 0.812268 | 9812.71 | 6643.97 | 0.112837 |            0.901745 |
|                4 | 0.871563 | 8189.91 | 5944.87 | 0.104658 |            0.933591 |
|                5 | 0.837077 | 9098.73 | 6577.61 | 0.111918 |            0.915711 |
|                6 | 0.84049  | 8783.32 | 6620.16 | 0.113857 |            0.917376 |
|                7 | 0.813833 | 9034.99 | 6549.1  | 0.115053 |            0.902763 |
|                8 | 0.840247 | 9332.62 | 6836.94 | 0.117101 |            0.916725 |
|                9 | 0.854961 | 9260.35 | 6713.11 | 0.11313  |            0.925135 |

| F1 Hypothesis Test   |       F1 |     σ 1 |              σ 2 | Distribution    |   Significant Level |
|----------------------|----------|---------|------------------|-----------------|---------------------|
| Best Fitting Model   | 0.071602 | 4439.12 |      4.87114e+06 | F(4.0454, 2186) |              0.01   |
| Worst Fitting Model  | 0.117877 | 3118.77 | 804247           | F(12.094, 2186) |              0.0001 |

Table 9: F2 Hypothesis Test

| Model        | Variable          |   Intercept |       AB |      NPS |       MF |       SD |       GR |       PR |     QAPS |      NSS |      DSS |
|--------------|-------------------|-------------|----------|----------|----------|----------|----------|----------|----------|----------|----------|
| Best Fitting | F Value           |    614.58   | 234.48   | 381.14   | 562.52   | 537.77   | 503.31   | 385.1    | 418.17   | 646.79   | 502.37   |
| Best Fitting | γ 1               |      0.0198 |   0.0893 |   0.4068 |   0.4108 |   0.42   |   0.456  |   0.5951 |   0.6102 |   0.6753 |   0.6692 |
| Model        | γ 2               |      0.0004 |   0.0057 |   0.1095 |   0.1085 |   0.1108 |   0.112  |   0.1629 |   0.1595 |   0.1789 |   0.1824 |
| Best Fitting | Significant Level |      1e-10  |   1e-08  |   1e-09  |   1e-10  |   1e-10  |   1e-10  |   1e-10  |   1e-11  |   1e-12  |   1e-11  |
| Worst        | F2                |   1017.1    | 471.84   | 573.85   | 872.23   | 845.57   | 774.72   | 344.85   | 367.06   | 560.84   | 432.05   |
| Fitting      | γ 1               |      0.0289 |   0.1302 |   0.5264 |   0.5279 |   0.5338 |   0.599  |   1.3826 |   1.3973 |   1.501  |   1.4639 |
| Model        | γ 2               |      0.0008 |   0.0115 |   0.176  |   0.1741 |   0.1758 |   0.1807 |   0.9202 |   0.9138 |   0.9341 |   0.876  |
| Worst        | Significant Level |      0      |   0.0001 |   0.0001 |   1e-05  |   1e-05  |   1e-05  |   0.0001 |   0.0001 |   0.0001 |   0.0001 |

cant influence on house price, and each of their influence varies a lot among the region. Hence it has also been proved that all of them have significant spatial non-stationarity. What ' s more, this simple comparison also hints that a better model may require a higher spatial non-stationarity estimation on variables and a lower spatial non-stationarity estimation on the intercept.

## Visual Content

### Page Preview

![Page 13](/projects/llms/images/2202.04358v1_page_13.png)

### Figures

![](/projects/llms/figures/2202.04358v1_page_13_figure_1.png)


![](/projects/llms/figures/2202.04358v1_page_13_figure_2.png)


![](/projects/llms/figures/2202.04358v1_page_13_figure_3.png)


![](/projects/llms/figures/2202.04358v1_page_13_figure_4.png)


![](/projects/llms/figures/2202.04358v1_page_13_figure_5.png)

