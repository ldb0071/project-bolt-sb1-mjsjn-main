Page 15

Table 7. AUC results(mean±std) on nine real-world AD datasets under the general setting. Best results and the second-best results are respectively highlighted in Red and Bold .

|              | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | One Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   | Ten Anomaly Examples (Random)   |
|--------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|
| Dataset      | SAOE                            | MLEP                            | FLOS                            | DevNet                          | DRA                             | AHL(DevNet)                     | AHL(DRA)                        | SAOE                            | MLEP                            | FLOS                            | DevNet                          | DRA                             | AHL(DevNet)                     | AHL(DRA)                        |
| Carpet       | 0.766±0.098                     | 0.701±0.091                     | 0.755±0.026                     | 0.778±0.055                     | 0.873±0.035                     | 0.802±0.018                     | 0.877±0.004                     | 0.755±0.136                     | 0.781±0.049                     | 0.780±0.009                     | 0.864±0.012                     | 0.945±0.014                     | 0.867±0.006                     | 0.953±0.001                     |
| Grid         | 0.921±0.032                     | 0.839±0.028                     | 0.871±0.076                     | 0.868±0.031                     | 0.972±0.016                     | 0.872±0.032                     | 0.975±0.005                     | 0.952±0.011                     | 0.980±0.009                     | 0.966±0.005                     | 0.901±0.016                     | 0.990±0.008                     | 0.914±0.003                     | 0.992±0.002                     |
| Leather      | 0.996±0.007                     | 0.781±0.020                     | 0.791±0.057                     | 0.874±0.016                     | 0.988±0.003                     | 0.880±0.005                     | 0.988±0.001                     | 1.000±0.000                     | 0.813±0.158                     | 0.993±0.004                     | 0.986±0.033                     | 1.000±0.000                     | 0.996±0.008                     | 1.000±0.000                     |
| Tile         | 0.935±0.034                     | 0.927±0.036                     | 0.787±0.038                     | 0.872±0.035                     | 0.966±0.014                     | 0.909±0.007                     | 0.968±0.001                     | 0.944±0.013                     | 0.988±0.009                     | 0.952±0.010                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     |
| Wood         | 0.948±0.009                     | 0.660±0.142                     | 0.927±0.065                     | 0.917±0.029                     | 0.987±0.012                     | 0.947±0.020                     | 0.987±0.003                     | 0.976±0.031                     | 0.999±0.002                     | 1.000±0.000                     | 0.999±0.000                     | 0.998±0.013                     | 1.000±0.000                     | 0.998±0.000                     |
| Bottle       | 0.989±0.019                     | 0.927±0.090                     | 0.975±0.023                     | 0.986±0.012                     | 1.000±0.000                     | 0.994±0.004                     | 1.000±0.000                     | 0.998±0.003                     | 0.981±0.004                     | 0.995±0.002                     | 0.996±0.005                     | 1.000±0.000                     | 0.998±0.001                     | 1.000±0.000                     |
| Capsule      | 0.611±0.109                     | 0.558±0.075                     | 0.666±0.020                     | 0.567±0.042                     | 0.646±0.029                     | 0.581±0.202                     | 0.665±0.030                     | 0.850±0.054                     | 0.818±0.063                     | 0.902±0.017                     | 0.872±0.017                     | 0.928±0.011                     | 0.885±0.012                     | 0.930±0.001                     |
| Pill         | 0.652±0.078                     | 0.656±0.061                     | 0.745±0.064                     | 0.779±0.018                     | 0.831±0.026                     | 0.781±0.087                     | 0.840±0.003                     | 0.872±0.049                     | 0.845±0.048                     | 0.929±0.012                     | 0.882±0.008                     | 0.918±0.009                     | 0.900±0.004                     | 0.918±0.001                     |
| Transistor   | 0.680±0.182                     | 0.695±0.124                     | 0.709±0.041                     | 0.732±0.075                     | 0.727±0.105                     | 0.737±0.098                     | 0.796±0.003                     | 0.860±0.053                     | 0.927±0.043                     | 0.862±0.037                     | 0.907±0.004                     | 0.919±0.003                     | 0.912±0.002                     | 0.926±0.009                     |
| Zipper       | 0.970±0.033                     | 0.856±0.086                     | 0.885±0.033                     | 0.914±0.027                     | 0.983±0.008                     | 0.928±0.006                     | 0.986±0.000                     | 0.995±0.004                     | 0.965±0.002                     | 0.990±0.008                     | 0.992±0.008                     | 1.000±0.000                     | 0.995±0.002                     | 1.000±0.000                     |
| Cable        | 0.819±0.060                     | 0.688±0.017                     | 0.790±0.039                     | 0.790±0.086                     | 0.855±0.007                     | 0.793±0.091                     | 0.858±0.011                     | 0.862±0.022                     | 0.857±0.062                     | 0.890±0.063                     | 0.901±0.006                     | 0.914±0.006                     | 0.907±0.004                     | 0.921±0.001                     |
| Hazelnut     | 0.961±0.042                     | 0.704±0.090                     | 0.976±0.021                     | 0.970±0.005                     | 0.982±0.005                     | 0.978±0.003                     | 0.989±0.004                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     | 1.000±0.000                     |
| Metal nut    | 0.922±0.033                     | 0.878±0.038                     | 0.930±0.022                     | 0.874±0.014                     | 0.950±0.011                     | 0.880±0.002                     | 0.952±0.003                     | 0.976±0.013                     | 0.974±0.009                     | 0.984±0.004                     | 0.992±0.003                     | 0.997±0.005                     | 0.997±0.003                     | 0.998±0.000                     |
| Screw        | 0.653±0.074                     | 0.675±0.294                     | 0.337±0.091                     | 0.766±0.045                     | 0.902±0.032                     | 0.769±0.031                     | 0.927±0.009                     | 0.975±0.023                     | 0.899±0.039                     | 0.940±0.017                     | 0.981±0.013                     | 0.978±0.012                     | 0.984±0.005                     | 0.985±0.002                     |
| Toothbrush   | 0.686±0.110                     | 0.617±0.058                     | 0.731±0.028                     | 0.790±0.029                     | 0.675±0.019                     | 0.794±0.016                     | 0.710±0.007                     | 0.865±0.062                     | 0.783±0.048                     | 0.900±0.008                     | 0.950±0.025                     | 0.908±0.007                     | 0.959±0.002                     | 0.921±0.007                     |
| MVTec AD     | 0.834±0.007                     | 0.744±0.019                     | 0.792±0.014                     | 0.832±0.016                     | 0.889±0.013                     | 0.843±0.021                     | 0.901±0.003                     | 0.926±0.010                     | 0.907±0.005                     | 0.939±0.007                     | 0.948±0.005                     | 0.966±0.002                     | 0.954±0.003                     | 0.970±0.002                     |
| AITEX        | 0.675±0.094                     | 0.564±0.055                     | 0.538±0.073                     | 0.609±0.054                     | 0.693±0.031                     | 0.704±0.004                     | 0.734±0.008                     | 0.874±0.024                     | 0.867±0.037                     | 0.841±0.049                     | 0.889±0.007                     | 0.892±0.007                     | 0.903±0.011                     | 0.925±0.013                     |
| SDD          | 0.781±0.009                     | 0.811±0.045                     | 0.840±0.043                     | 0.851±0.003                     | 0.907±0.002                     | 0.864±0.001                     | 0.909±0.001                     | 0.955±0.020                     | 0.783±0.013                     | 0.967±0.018                     | 0.985±0.004                     | 0.990±0.000                     | 0.991±0.001                     | 0.991±0.000                     |
| ELPV         | 0.635±0.092                     | 0.578±0.062                     | 0.457±0.056                     | 0.810±0.024                     | 0.676±0.003                     | 0.828±0.005                     | 0.723±0.008                     | 0.793±0.047                     | 0.794±0.047                     | 0.818±0.032                     | 0.843±0.001                     | 0.843±0.002                     | 0.849±0.003                     | 0.850±0.004                     |
| Optical      | 0.815±0.014                     | 0.516±0.009                     | 0.518±0.003                     | 0.513±0.001                     | 0.880±0.002                     | 0.547±0.009                     | 0.888±0.007                     | 0.941±0.013                     | 0.740±0.039                     | 0.720±0.055                     | 0.785±0.012                     | 0.966±0.002                     | 0.841±0.010                     | 0.976±0.004                     |
| Mastcam      | 0.662±0.018                     | 0.625±0.045                     | 0.542±0.017                     | 0.627±0.049                     | 0.709±0.011                     | 0.644±0.013                     | 0.743±0.003                     | 0.810±0.029                     | 0.798±0.026                     | 0.703±0.029                     | 0.797±0.021                     | 0.849±0.003                     | 0.825±0.020                     | 0.855±0.005                     |
| BrainMRI     | 0.531±0.060                     | 0.632±0.017                     | 0.693±0.036                     | 0.853±0.045                     | 0.747±0.001                     | 0.866±0.004                     | 0.760±0.013                     | 0.900±0.041                     | 0.959±0.011                     | 0.955±0.011                     | 0.951±0.007                     | 0.971±0.001                     | 0.959±0.008                     | 0.977±0.001                     |
| HeadCT       | 0.597±0.022                     | 0.758±0.038                     | 0.698±0.092                     | 0.755±0.029                     | 0.804±0.010                     | 0.781±0.007                     | 0.825±0.014                     | 0.935±0.021                     | 0.972±0.014                     | 0.971±0.004                     | 0.997±0.002                     | 0.988±0.001                     | 0.999±0.003                     | 0.993±0.002                     |
| Hyper-Kvasir | 0.498±0.100                     | 0.445±0.040                     | 0.668±0.004                     | 0.734±0.020                     | 0.712±0.010                     | 0.768±0.015                     | 0.742±0.015                     | 0.666±0.050                     | 0.600±0.069                     | 0.773±0.029                     | 0.822±0.031                     | 0.844±0.001                     | 0.873±0.009                     | 0.880±0.003                     |

Table 8. AUC results(mean±std) on nine real-world AD datasets under the hard setting. Best results and the second-best results are respectively highlighted in Red and Bold . Carpet and Meta nut are two subsets of MVTec AD. The same set of datasets is used as in [15].

|         |                               | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | One Example from One Anomaly Class   | Ten Example from One Anomaly Class   | Ten Example from One Anomaly Class   | Ten Example from One Anomaly Class   | Ten Example from One Anomaly Class   | Ten Example from One Anomaly Class   |
|---------|-------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|--------------------------------------|
| Dataset | Dataset                       | SAOE                                 | MLEP                                 | FLOS                                 | DevNet                               | DRA                                  | AHL(DevNet)                          | AHL(DRA)                             | SAOE                                 | MLEP                                 | FLOS                                 | DevNet                               | DRA                                  | AHL(DevNet)                          |
|         | Color                         | 0.763±0.100                          | 0.547±0.056                          | 0.467±0.278                          | 0.701±0.046                          | 0.890±0.011                          | 0.718±0.009                          | 0.894±0.004                          | 0.467±0.067                          | 0.698±0.025                          | 0.760±0.005                          | 0.774±0.009                          | 0.899±0.019                          | 0.778±0.004                          |
|         | Cut                           | 0.664±0.165                          | 0.658±0.056                          | 0.685±0.007                          | 0.679±0.018                          | 0.890±0.024                          | 0.684±0.014                          | 0.934±0.003                          | 0.793±0.175                          | 0.653±0.120                          | 0.688±0.059                          | 0.817±0.021                          | 0.942±0.012                          | 0.825±0.006                          |
|         | Hole                          | 0.772±0.071                          | 0.653±0.065                          | 0.594±0.142                          | 0.729±0.032                          | 0.915±0.045                          | 0.736±0.062                          | 0.935±0.014                          | 0.831±0.125                          | 0.674±0.076                          | 0.733±0.014                          | 0.808±0.016                          | 0.958±0.031                          | 0.815±0.036                          |
|         | Metal                         | 0.780±0.172                          | 0.706±0.047                          | 0.701±0.028                          | 0.822±0.016                          | 0.877±0.013                          | 0.846±0.012                          | 0.931±0.007                          | 0.883±0.043                          | 0.764±0.061                          | 0.678±0.083                          | 0.885±0.012                          | 0.916±0.017                          | 0.899±0.026                          |
|         | Thread                        | 0.787±0.204                          | 0.831±0.117                          | 0.941±0.005                          | 0.937±0.017                          | 0.954±0.010                          | 0.941±0.006                          | 0.966±0.005                          | 0.834±0.297                          | 0.967±0.006                          | 0.946±0.005                          | 0.981±0.005                          | 0.985±0.005                          | 0.984±0.013                          |
|         | Mean                          | 0.753±0.055                          | 0.679±0.029                          | 0.678±0.040                          | 0.774±0.007                          | 0.905±0.006                          | 0.785±0.015                          | 0.932±0.003                          | 0.762±0.073                          | 0.751±0.023                          | 0.761±0.012                          | 0.853±0.005                          | 0.940±0.006                          | 0.860±0.013                          |
|         | Bent                          | 0.864±0.032                          | 0.743±0.013                          | 0.851±0.046                          | 0.817±0.033                          | 0.952±0.015                          | 0.831±0.020                          | 0.954±0.003                          | 0.901±0.023                          | 0.956±0.013                          | 0.827±0.075                          | 0.907±0.018                          |                                      | 0.909±0.016                          |
|         | Color                         | 0.857±0.037                          | 0.835±0.075                          | 0.821±0.059                          | 0.903±0.019                          | 0.930±0.021                          | 0.910±0.008                          | 0.933±0.008                          | 0.879±0.018                          | 0.945±0.039                          | 0.978±0.008                          | 0.992±0.015                          | 0.987±0.003 0.956±0.009              | 0.995±0.002                          |
|         | Flip                          | 0.751±0.090                          | 0.813±0.031                          | 0.799±0.058                          | 0.751±0.039                          | 0.931±0.017                          | 0.755±0.022                          | 0.931±0.001                          | 0.795±0.062                          | 0.805±0.057                          | 0.942±0.009                          | 0.982±0.010                          | 0.931±0.010                          | 0.987±0.003                          |
|         | Scratch                       | 0.792±0.075                          | 0.907±0.085                          | 0.947±0.027                          | 0.974±0.061                          | 0.929±0.009                          | 0.981±0.035                          | 0.934±0.005                          | 0.845±0.041                          | 0.805±0.153                          | 0.943±0.002                          | 0.998±0.005                          | 0.998±0.006                          | 0.998±0.001                          |
|         | Mean                          |                                      | 0.825±0.023                          | 0.855±0.024                          |                                      |                                      |                                      |                                      |                                      | 0.878±0.058                          |                                      | 0.970±0.009                          | 0.968±0.006                          |                                      |
|         | Broken end                    | 0.816±0.029 0.778±0.068              | 0.441±0.111                          | 0.645±0.030                          | 0.861±0.019 0.702±0.037              | 0.936±0.011 0.696±0.057              | 0.869±0.004 0.716±0.014              | 0.939±0.004 0.704±0.005              | 0.855±0.016 0.712±0.068              | 0.732±0.065                          | 0.922±0.014 0.585±0.037              | 0.658±0.062                          | 0.708±0.062                          | 0.972±0.002 0.688±0.013              |
|         | Broken pick                   | 0.644±0.039                          | 0.476±0.070                          | 0.598±0.023                          | 0.567±0.016                          | 0.719±0.004                          | 0.575±0.005                          | 0.727±0.003                          | 0.629±0.012                          | 0.555±0.027                          | 0.548±0.054                          | 0.595±0.017                          | 0.671±0.034                          | 0.612±0.005                          |
|         | Cut selvage                   | 0.681±0.077                          | 0.434±0.149                          | 0.694±0.036                          | 0.674±0.021                          | 0.751±0.006                          | 0.680±0.017                          | 0.753±0.007                          | 0.770±0.014                          | 0.682±0.025                          | 0.745±0.035                          | 0.703±0.062                          | 0.777±0.021                          | 0.737±0.012                          |
|         | Fuzzyball                     | 0.650±0.064                          | 0.525±0.157                          | 0.525±0.043                          | 0.629±0.103                          | 0.631±0.018                          | 0.644±0.031                          | 0.647±0.007                          | 0.842±0.026                          | 0.677±0.223                          | 0.550±0.082                          | 0.736±0.101                          | 0.749±0.033                          | 0.755±0.002                          |
|         | Nep                           | 0.710±0.044                          | 0.517±0.059                          | 0.734±0.038                          | 0.741±0.011                          | 0.685±0.010                          | 0.754±0.012                          | 0.703±0.005                          | 0.771±0.032                          | 0.740±0.052                          | 0.746±0.060                          | 0.806±0.039                          | 0.784±0.025                          | 0.836±0.007                          |
|         | Weft crack                    | 0.582±0.108                          | 0.400±0.029                          | 0.546±0.114                          | 0.561±0.085                          | 0.693±0.002                          | 0.588±0.018                          | 0.706±0.009                          | 0.618±0.172                          | 0.370±0.037                          | 0.636±0.051                          | 0.614±0.097                          | 0.710±0.016                          | 0.624±0.005                          |
|         | Mean                          | 0.674±0.034                          | 0.466±0.030                          | 0.624±0.024                          | 0.646±0.014 0.620±0.057              | 0.696±0.011                          | 0.660±0.007                          | 0.707±0.007                          | 0.724±0.032                          | 0.626±0.041                          | 0.635±0.043                          | 0.685±0.016                          | 0.733±0.011                          | 0.709±0.006                          |
|         | Mono                          | 0.563±0.102 0.665±0.173              | 0.649±0.027 0.483±0.247              | 0.717±0.025 0.665±0.021              | 0.705±0.011                          | 0.762±0.017 0.681±0.026              | 0.638±0.019 0.717±0.007              | 0.774±0.013 0.705±0.006              | 0.569±0.035 0.796±0.084              | 0.756±0.045 0.734±0.078              | 0.629±0.072 0.662±0.042              | 0.639±0.067 0.806±0.027              | 0.735±0.008 0.806±0.004              | 0.663±0.007 0.842±0.003              |
|         | Poly                          | 0.614±0.048                          | 0.566±0.111                          | 0.691±0.008                          | 0.663±0.008                          |                                      | 0.678±0.006                          | 0.740±0.003                          | 0.683±0.047                          | 0.745±0.020                          | 0.646±0.032                          | 0.722±0.018                          | 0.771±0.005                          | 0.752±0.005                          |
|         | Mean Bedrock                  | 0.636±0.072                          | 0.532±0.036                          | 0.499±0.056                          | 0.508±0.107                          | 0.722±0.006 0.653±0.019              | 0.533±0.065                          | 0.679±0.012                          | 0.636±0.068                          | 0.512±0.062                          | 0.499±0.098                          | 0.586±0.012                          | 0.654±0.013                          | 0.589±0.010                          |
|         | Broken-rock                   | 0.699±0.058                          | 0.544±0.088                          | 0.569±0.025                          | 0.558±0.016                          | 0.640±0.023                          | 0.572±0.014                          | 0.661±0.009                          | 0.712±0.052                          | 0.651±0.063                          | 0.608±0.085                          | 0.562±0.033                          | 0.704±0.007                          | 0.572±0.024                          |
|         | Drill-hole                    | 0.697±0.074                          | 0.636±0.066                          | 0.539±0.077                          | 0.555±0.026                          | 0.642±0.035                          | 0.563±0.012                          | 0.654±0.004                          | 0.682±0.042                          | 0.660±0.002                          | 0.601±0.009                          | 0.590±0.074                          | 0.757±0.008                          | 0.610±0.075                          |
|         | Drt                           |                                      | 0.624±0.042                          |                                      |                                      |                                      |                                      | 0.724±0.006                          | 0.761±0.062                          | 0.616±0.048                          | 0.652±0.024                          | 0.620±0.031                          | 0.757±0.006                          | 0.629±0.016                          |
|         |                               | 0.735±0.020                          |                                      | 0.591±0.042                          | 0.570±0.048                          | 0.733±0.027                          | 0.581±0.023                          |                                      |                                      |                                      |                                      |                                      |                                      |                                      |
|         | Dump-pile                     | 0.682±0.022                          | 0.545±0.127                          | 0.508±0.021 0.551±0.030              | 0.510±0.008 0.507±0.039              | 0.741±0.022                          | 0.519±0.004                          | 0.756±0.011                          | 0.750±0.037                          | 0.696±0.047 0.671±0.032              | 0.700±0.070 0.736±0.041              | 0.689±0.070 0.640±0.012              | 0.757±0.008 0.749±0.009              | 0.695±0.021 0.647±0.008              |
|         | Float                         | 0.711±0.041                          | 0.530±0.075 0.476±0.014              | 0.462±0.077                          |                                      | 0.688±0.031                          | 0.524±0.017 0.463±0.008              | 0.702±0.005 0.616±0.013              | 0.718±0.064                          | 0.473±0.047                          |                                      | 0.561±0.053                          | 0.689±0.010                          | 0.572±0.015                          |
|         | Meteorite                     | 0.669±0.037                          |                                      |                                      | 0.436±0.033                          | 0.604±0.020                          | 0.515±0.013                          |                                      | 0.647±0.030                          |                                      | 0.568±0.053                          |                                      |                                      |                                      |
|         | Scuff                         | 0.679±0.048                          | 0.492±0.037                          | 0.508±0.070                          | 0.496±0.121                          | 0.573±0.017                          |                                      | 0.581±0.020                          | 0.676±0.019                          | 0.504±0.052                          | 0.575±0.042                          | 0.447±0.043                          | 0.626±0.016                          | 0.506±0.104                          |
|         | Veins                         | 0.688±0.069                          | 0.489±0.028                          | 0.493±0.052                          | 0.530±0.006                          | 0.650±0.012                          | 0.548±0.010                          | 0.687±0.017                          | 0.686±0.053                          | 0.510±0.090                          | 0.608±0.044                          | 0.577±0.029                          | 0.644±0.007                          | 0.598±0.037                          |
|         | Mean                          | 0.689±0.037                          | 0.541±0.007 0.438±0.111              | 0.524±0.013 0.703±0.040              | 0.519±0.014 0.682±0.007              | 0.658±0.021 0.788±0.008              | 0.535±0.003                          | 0.673±0.010                          | 0.697±0.014                          | 0.588±0.016                          | 0.616±0.021 0.764±0.066              | 0.588±0.025 0.837±0.014              | 0.704±0.007 0.820±0.005              | 0.602±0.008                          |
|         | Barretts                      | 0.382±0.117 0.367±0.050              |                                      |                                      | 0.608±0.077                          | 0.643±0.013                          | 0.701±0.013 0.629±0.027              | 0.792±0.007                          | 0.698±0.037 0.661±0.034              | 0.540±0.014 0.480±0.107              | 0.810±0.034                          | 0.790±0.017                          | 0.829±0.006                          | 0.850±0.002                          |
|         | Barretts-short-seg            |                                      | 0.532±0.075                          | 0.538±0.033                          | 0.567±0.034                          | 0.759±0.015                          | 0.583±0.015                          | 0.651±0.006                          | 0.820±0.034                          | 0.646±0.036                          | 0.815±0.022                          | 0.867±0.004                          | 0.854±0.006                          | 0.812±0.005                          |
|         | Esophagitis-a Esophagitis-b-d | 0.358±0.039                          | 0.457±0.086                          | 0.505±0.039                          | 0.535±0.025                          | 0.604±0.022                          | 0.562±0.010                          | 0.760±0.006 0.622±0.014              | 0.611±0.017                          | 0.621±0.042                          | 0.754±0.073                          |                                      |                                      | 0.876±0.002                          |
|         |                               | 0.518±0.063                          | 0.491±0.084                          | 0.536±0.040                          |                                      |                                      |                                      |                                      |                                      |                                      |                                      | 0.812±0.025                          | 0.785±0.006                          | 0.842±0.003                          |
|         |                               |                                      |                                      |                                      |                                      |                                      |                                      |                                      | 0.698±0.021                          |                                      | 0.786±0.021                          | 0.827±0.008                          | 0.822±0.013                          | 0.845±0.003                          |
|         |                               | 0.406±0.018                          |                                      | 0.571±0.004                          | 0.598±0.006                          |                                      |                                      | 0.706±0.007                          |                                      | 0.571±0.014                          |                                      |                                      |                                      |                                      |
|         | Mean                          |                                      | 0.480±0.044                          |                                      |                                      | 0.699±0.009                          | 0.619±0.005                          |                                      |                                      |                                      |                                      |                                      |                                      |                                      |

## C.3. More Ablation Study Results

Class-level Results under Hard Setting To evaluate the effectiveness of each module in our AHL approach, we compared it with three variants: the base model ( DRA ), the base model with HADG component ( + HADG ), and the base model using random heterogeneous anomaly distribution generation ( + RamHADG ). Table 9 shows the detailed results of class-level anomaly detection in the hard setting. The results show that all the modules in the AHL framework contribute to improving the detection performance on unseen anomaly classes, demonstrating the importance of

anomaly heterogeneity.

Importance of Pseudo Anomalies Moreover, since DevNet [32] does not use pseudo anomalies, we also evaluate the impact of removing the pseudo anomalies on the AHL framework when using DevNet as the base model. As shown in Figure 4, AHL (DevNet) remains substantially better than the original DevNet model in such cases.

Effectiveness of Overlapping in HADG Module Table 10 shows the results of AHL (DRA) using three overlapping types: overlap occurring exclusively in (1) the query set ( D s -> D q ), (2) the support set ( D q -> D s ), and (3) in both

Table 9. Ablation study class-level results of AHL and its three main variants under hard settings. Best results and the second-best results are respectively highlighted in Red and Bold .

| Datsset      | Subset                           | DRA                                                                     | + RamHADG                                                               | + HADG                                                                              | AHL(DevNet)                         |
|--------------|----------------------------------|-------------------------------------------------------------------------|-------------------------------------------------------------------------|-------------------------------------------------------------------------------------|-------------------------------------|
| Carpet       | Color Cut Hole Metal Thread Mean | 0.899±0.019 0.942±0.012 0.958±0.031 0.916±0.017 0.985±0.005 0.940±0.006 | 0.917±0.004 0.938±0.004 0.954±0.010 0.919±0.008 0.985±0.003 0.943±0.002 | 0.919±0.003 0.943±0.001 0.952±0.002 0.914±0.006 0.988±0.002 0.943±0.003 0.719±0.005 | 0.929±0.007 0.943±0.002 0.960±0.003 |
| AITEX        | Broken end                       |                                                                         | 0.714±0.011                                                             |                                                                                     |                                     |
| AITEX        | Broken pick                      | 0.671±0.034                                                             |                                                                         |                                                                                     | 0.683±0.002                         |
| AITEX        |                                  |                                                                         |                                                                         |                                                                                     | 0.921±0.003                         |
| AITEX        | Fuzzyball Mean                   | 0.749±0.033                                                             | 0.742±0.010                                                             | 0.756±0.021                                                                         | 0.991±0.001 0.775±0.024             |
| AITEX        |                                  |                                                                         |                                                                         |                                                                                     | 0.949±0.002                         |
|              |                                  | 0.708±0.062                                                             |                                                                         |                                                                                     | 0.735±0.010                         |
|              |                                  |                                                                         | 0.670±0.003                                                             | 0.678±0.005                                                                         |                                     |
|              | Cut selvage                      | 0.777±0.021                                                             | 0.777±0.009                                                             | 0.779±0.018                                                                         | 0.781±0.006                         |
|              | Nep                              | 0.784±0.025                                                             | 0.786±0.007                                                             | 0.788±0.005                                                                         | 0.792±0.007                         |
|              | Weft crack                       | 0.710±0.016                                                             | 0.708±0.003                                                             | 0.711±0.003                                                                         | 0.713±0.003                         |
|              |                                  | 0.733±0.011                                                             | 0.733±0.005                                                             | 0.739±0.007                                                                         | 0.747±0.002                         |
| elpv         | Mono                             | 0.735±0.008                                                             | 0.738±0.008                                                             | 0.739±0.006                                                                         | 0.745±0.004                         |
| elpv         | Poly                             | 0.806±0.004                                                             | 0.809±0.006                                                             | 0.817±0.012                                                                         | 0.831±0.011                         |
| elpv         | Mean                             | 0.771±0.005                                                             | 0.774±0.004                                                             | 0.784±0.004                                                                         | 0.788±0.003                         |
| Hyper-Kvasir | Barretts                         | 0.820±0.005                                                             | 0.819±0.006                                                             | 0.822±0.009                                                                         | 0.829±0.002                         |
| Hyper-Kvasir | Barretts-short-seg               | 0.829±0.006                                                             | 0.864±0.012                                                             | 0.887±0.016                                                                         | 0.895±0.003                         |
| Hyper-Kvasir | Esophagitis-a                    | 0.854±0.006                                                             | 0.863±0.000                                                             | 0.871±0.005                                                                         | 0.878±0.021                         |
| Hyper-Kvasir | Esophagitis-b-d                  | 0.785±0.006                                                             | 0.795±0.005                                                             | 0.806±0.004                                                                         | 0.815±0.010                         |
| Hyper-Kvasir | Mean                             | 0.822±0.013                                                             | 0.835±0.004                                                             | 0.847±0.008                                                                         | 0.854±0.004                         |

Figure 4. Comparison of the AUC performance between DevNet and AHL (DRA) without the pseudo anomaly augmentation generation module. Here wo. aug indicates the augmentation techniques are excluded during training.

<!-- image -->

sets ( D s <> D q ). It is clear that the overlapping between D q and D s typically does not lead to performance improvement.

| Dataset      |   D s - > D q |   D q - > D s |   D s <> D q |   Ours |
|--------------|---------------|---------------|--------------|--------|
| AITEX        |         0.918 |         0.917 |        0.917 |  0.925 |
| SDD          |         0.988 |         0.99  |        0.991 |  0.991 |
| ELPV         |         0.853 |         0.844 |        0.842 |  0.85  |
| BrainMRI     |         0.97  |         0.969 |        0.97  |  0.977 |
| HeadCT       |         0.993 |         0.991 |        0.993 |  0.993 |
| Hyper-Kvasir |         0.872 |         0.875 |        0.876 |  0.88  |

Table 10. Results with various overlaps.