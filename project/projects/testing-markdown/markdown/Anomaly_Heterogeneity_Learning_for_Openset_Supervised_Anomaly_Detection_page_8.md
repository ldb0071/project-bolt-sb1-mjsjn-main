Page 8

The above settings are used by default for the reported results of AHL across all the datasets. The results of MLEP, SAOE, and FLOS are taken from [15]. The results of DevNet and DRA are reproduced using their official codes to obtain the features used in AHL , meaning that DevNet and AHL (DevNet) use the same set of features, which also applies to DRA and AHL (DRA) (see Appendix B for more implementation details).

## 4.2. Performance under General Settings

Table 1 shows the comparison results under the general setting, where models are trained using one or ten randomly sampled anomaly examples. The results on MVTec AD are averaged over its 16 data subsets (see Appendix C for detailed results on the subsets). Overall, our approach AHL brings consistently substantial improvement to the re-

Table 2. AUC results(mean±std) on nine real-world AD datasets under the hard setting. Best results and the second-best results are respectively highlighted in red and bold .' ↑ ' (' ↑ ') indicates increased performance over DRA (DevNet). Carpet and Meta nut are two subsets of MVTec AD. The same set of datasets is used as in [15].

| Dataset                             | SAOE                                | MLEP                                | FLOS                                | DevNet                              | DRA                                 | AHL (DevNet)                        | AHL (DRA)                           |
|-------------------------------------|-------------------------------------|-------------------------------------|-------------------------------------|-------------------------------------|-------------------------------------|-------------------------------------|-------------------------------------|
| Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class | Ten Examples from One Anomaly Class |
| Carpet (mean)                       | 0.762±0.073                         | 0.935±0.013                         | 0.761±0.012                         | 0.853±0.005                         | 0.940±0.006                         | 0.860±0.013 ↑                       | 0.949±0.002 ↑                       |
| Metal nut (mean)                    | 0.855±0.016                         | 0.945±0.017                         | 0.922±0.014                         | 0.970±0.009                         | 0.968±0.006                         | 0.972±0.002 ↑                       | 0.971±0.001 ↑                       |
| AITEX (mean)                        | 0.724±0.032                         | 0.733±0.009                         | 0.635±0.043                         | 0.685±0.016                         | 0.733±0.011                         | 0.709±0.006 ↑                       | 0.747±0.002 ↑                       |
| ELPV (mean)                         | 0.683±0.047                         | 0.766±0.029                         | 0.646±0.032                         | 0.722±0.018                         | 0.771±0.005                         | 0.752±0.005 ↑                       | 0.788±0.003 ↑                       |
| Mastcam (mean)                      | 0.697±0.014                         | 0.695±0.004                         | 0.616±0.021                         | 0.588±0.025                         | 0.704±0.007                         | 0.602±0.008 ↑                       | 0.721±0.003 ↑                       |
| Hyper-Kvasir (mean)                 | 0.698±0.021                         | 0.844±0.009                         | 0.786±0.021                         | 0.827±0.008                         | 0.822±0.013                         | 0.845±0.003 ↑                       | 0.854±0.004 ↑                       |
| One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  | One Example from One Anomaly Class  |
| Carpet (mean)                       | 0.753±0.055                         | 0.679±0.029                         | 0.678±0.040                         | 0.774±0.007                         | 0.905±0.006                         | 0.785±0.015 ↑                       | 0.932±0.003 ↑                       |
| Metal nut (mean)                    | 0.816±0.029                         | 0.825±0.023                         | 0.855±0.024                         | 0.861±0.019                         | 0.936±0.011                         | 0.869±0.004 ↑                       | 0.939±0.004 ↑                       |
| AITEX (mean)                        | 0.674±0.034                         | 0.466±0.030                         | 0.624±0.024                         | 0.646±0.014                         | 0.696±0.011                         | 0.660±0.007 ↑                       | 0.707±0.007 ↑                       |
| ELPV (mean)                         | 0.614±0.048                         | 0.566±0.111                         | 0.691±0.008                         | 0.663±0.008                         | 0.722±0.006                         | 0.678±0.006 ↑                       | 0.740±0.003 ↑                       |
| Mastcam (mean)                      | 0.689±0.037                         | 0.541±0.007                         | 0.524±0.013                         | 0.519±0.014                         | 0.658±0.021                         | 0.535±0.003 ↑                       | 0.673±0.010 ↑                       |
| Hyper-Kvasir (mean)                 | 0.406±0.018                         | 0.480±0.044                         | 0.571±0.004                         | 0.598±0.006                         | 0.699±0.009                         | 0.619±0.005 ↑                       | 0.706±0.007 ↑                       |

spective DRA and DevNet in both ten-shot and one-shot setting protocols across all the datasets of three application scenarios. Since DRA is a stronger base model than DevNet, AHL (DRA) generally obtains much better performance than AHL (DevNet). On average, AHL respectively enhances the performance of DRA and DevNet by up to 4% and 9% AUC, indicating that the anomaly heterogeneity learned by AHL enable the base models to gain significantly improved generalization ability.

## 4.3. Generalization to Unseen Anomaly Classes

Table 2 shows the comparison results under the hard setting, where models are trained with one or ten examples randomly sampled from exclusively one known anomaly class to detect the anomalies in the rest of all other anomaly classes. This protocol means that we can obtain one AUC result for having each anomaly class as the seen anomaly class. The reported results here are averaged over all the anomaly classes (see Appendix C for detailed class-level results). In general, our models AHL (DRA) and AHL (DevNet) - achieves the best AUC results in both M = 1 and M = 10 settings. To be more precise, AHL respectively improves the performances of DRA and DevNet by up to 3 . 2% and 3% AUC. Similar to the general setting, AHL (DRA) is the best performer. Due to the fact that the model is only exposed to one single anomaly class, the improvement is fully due to the ability of AHL in generalizing to detect unseen anomaly classes.

## 4.4. Unseen Anomaly Detection in Novel Domains

We evaluate the effectiveness of AHL in generalizing to unseen anomalies in a novel domain ( i.e ., a cross-domain AD task), where a model is trained on a source domain and is subsequently tested on datasets from a target domain that differs from the source. This is used to further verify the generalization capacity of AHL . Specifically, following the