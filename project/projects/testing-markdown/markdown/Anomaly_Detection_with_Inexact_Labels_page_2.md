Page 2

## 1 Introduction

Anomaly detection is an important machine learning task, which is a task to find the anomalous instances in a dataset. Anomaly detection has been used in a wide variety of applications (Chandola et al., 2009; Patcha and Park, 2007; Hodge and Austin, 2004), such as network intrusion detection for cyber-security (Dokas et al., 2002; Yamanishi et al., 2004), fraud detection for credit cards (Aleskerov et al., 1997), defect detection in industrial machines (Fujimaki et al., 2005; Id'e and Kashima, 2004) and disease outbreak detection (Wong et al., 2003).

Many unsupervised anomaly detection methods have been proposed (Breunig et al., 2000; Scholkopf et al., 2001; Liu et al., 2008; Sakurada and Yairi, 2014). When anomaly labels, which indicate whether each instance is anomalous, are given, the anomaly detection performance can be improved (Singh and Silakari, 2009; Mukkamala et al., 2005; Rapaka et al., 2003; Nadeem et al., 2016; Gao et al., 2006; Das et al., 2016, 2017). However, it is difficult to attach exact anomaly labels in some situations. Consider such example in server system failure detection. System operators often do not know the exact time of failures; they only know that a failure occurred within a certain period of time. In this case, anomaly labels can be attached to instances in a certain period of time, in which non-anomalous instances might be included. Another example is detecting anomalous IoT devices connected to a server. Even when the server displays unusual behavior, we sometimes cannot identify which IoT devices are anomalous. In these situations, only inexact anomaly labels are available.

In this paper, we propose a supervised anomaly detection method for data with inexact anomaly labels. An inexact anomaly label is attached to a set of instances, indicating that at least one instance in the set is anomalous. We call this set an inexact anomaly set. First, we define an extension of the area under the ROC curve (AUC) for performance measurement with inexact labels, which we call an inexact AUC . Then we develop an anomaly detection method that maximizes the inexact AUC. With the proposed method, a function, which outputs an anomaly score given an instance, is modeled by the reconstruction error with autoencoders, which are a successfully used neural network-based

Figure 1: Example of anomalous (circle) and non-anomalous (triangle) instances, and inexact anomaly sets (red or blue) in an instance space. Instances with identical color (red or blue) are contained in the same inexact anomaly set. White circles are test anomalous instances.

<!-- image -->

unsupervised anomaly detection method (Sakurada and Yairi, 2014; Sabokrou et al., 2016; Chong and Tay, 2017; Zhou and Paffenroth, 2017). Note that the proposed method can use any unsupervised anomaly detection methods with learnable parameters instead of autoencoders, such as variational autoencoders (Kingma and Wellniga, 2014), energy-based models (Zhai et al., 2016), and isolation forests (Liu et al., 2008). The parameters of the anomaly score function are trained so that the anomaly scores for non-anomalous instances become low while the smooth approximation of the inexact AUC becomes high. Since our objective function is differentiable, the anomaly score function can be estimated efficiently using stochastic gradient-based optimization methods.

The proposed method performs well even when only a few inexact labels are given since it incorporates an unsupervised anomaly detection mechanism, which works without label information. In addition, the proposed method is robust to class imbalance since our proposed inexact AUC maximization is related to AUC maximization, which achieved high performance on imbalanced data classification tasks (Cortes and Mohri, 2004). Class imbalance robustness is important for anomaly detection since anomalous instances occur more rarely than non-anomalous instances.