Page 7

Anumber of obtained qualitative examples are presented in Figure 8. As one can observe, the obtained anomaly masks are very detailed and resemble the given ground truth labels to a high degree of accuracy. Consequently, DRÆM achieves state-of-the-art quantitative results across all MVTec classes for surface anomaly detection as well as localization.

Surface Anomaly Detection. Table 1 quantitatively compares DRÆM with recent approaches on the task of image-level surface anomaly detection . DRÆM significantly outperforms all recent surface anomaly detec-

Table 1. Results for the task of surface anomaly detection on the MVTecdataset (AUROC). An average score over all classes is also reported the last row ( avg ).

| Class      |   [1] |   [26] |   [4] |   [31] |   [20] |   [11] |   DRÆM |
|------------|-------|--------|-------|--------|--------|--------|--------|
| bottle     |  79.4 |   98.3 |  99   |   99.9 |  100   |   99.9 |   99.2 |
| capsule    |  72.1 |   68.7 |  86.1 |   88.4 |   92.3 |   91.3 |   98.5 |
| grid       |  74.3 |   86.7 |  81   |   99.6 |   92.9 |   96.7 |   99.9 |
| leather    |  80.8 |   94.4 |  88.2 |  100   |  100   |  100   |  100   |
| pill       |  67.1 |   76.8 |  87.9 |   83.8 |   83.4 |   93.3 |   98.9 |
| tile       |  72   |   96.1 |  99.1 |   98.7 |   97.4 |   98.1 |   99.6 |
| transistor |  80.8 |   79.4 |  81.8 |   90.9 |   95.9 |   97.4 |   93.1 |
| zipper     |  74.4 |   78.1 |  91.9 |   98.1 |   97.9 |   90.3 |  100   |
| cable      |  71.1 |   66.5 |  86.2 |   81.9 |   94   |   92.7 |   91.8 |
| carpet     |  82.1 |   90.3 |  91.6 |   84.2 |   95.5 |   99.8 |   97   |
| hazelnut   |  87.4 |  100   |  93.1 |   83.3 |   98.7 |   92   |  100   |
| metal nut  |  69.4 |   81.5 |  82   |   88.5 |   93.1 |   98.7 |   98.7 |
| screw      | 100   |  100   |  54.9 |   84.5 |   81.2 |   85.8 |   93.9 |
| toothbrush |  70   |   95   |  95.3 |  100   |   95.8 |   96.1 |  100   |
| wood       |  92   |   97.9 |  97.7 |   93   |   97.6 |   99.2 |   99.1 |
| avg        |  78.2 |   87.3 |  87.7 |   91.7 |   94.4 |   95.5 |   98   |

on methods, achieving the highest AUROC in 9 out of 15 classes and achieving comparable results in the other classes. It surpasses the previous best state-of-the-art approach by 2 . 5 percentage points. The reduced performance in some classes could be explained by particularly difficult anomalies that are close to the normal image distribution. The absence of a part of the object is especially difficult to detect. Regions, where the object features are missing, usually contain other commonly occurring features. This makes such anomalies difficult to distinguish from anomaly-free regions. An example of this can be seen in Figure 6, where some of the transistor leads had been cut. The ground truth marks the area where the broken lead should be as anomalous. DRÆM only detects anomalous features in a small region of the cut lead, as the background features are common during training.

Anomaly Localization. Table 2 compares DRÆM to the recent state-of-the-art on the task of pixel-level surface anomaly detection . DRÆM achieves comparable results to the previous best-performing methods in terms of AUROC scores and surpasses the state-of-the-art by 13 . 4 percentage points in terms of AP. A better AP score is achieved in 11 out of 15 classes and is comparable to the state-of-the-art in other classes. A qualitative comparison with the state-ofthe-art method Uninformed Students [4] and PaDim [11] is shown in Figure 7. DRÆM achieves a significant improvement in anomaly segmentation accuracy.

A detailed inspection showed that some of the detection errors can be attributed to the inaccurate ground truth labels on ambiguous anomalies. An example of this is shown in Figure 6, where the ground truth covers the entire surface of the pill, yet only the yellow dots are anomalous. DRÆM produces an anomaly map that correctly localizes the yellow dots, but the discrepancy with the ground truth mask

Figure 6. The original image (a) contains anomalies which are difficult to mark in the ground truth mask (b) which causes a discrepancy between the ground truth and the output anomaly map (c,d).

<!-- image -->

Figure 7. The anomalous images are shown in the first row. The middle three rows show the anomaly maps generated by our implementation of Uninformed Students [4], PaDim [11] and DRÆM, respectively. The last row shows the direct anomaly map output of DRÆM.

<!-- image -->