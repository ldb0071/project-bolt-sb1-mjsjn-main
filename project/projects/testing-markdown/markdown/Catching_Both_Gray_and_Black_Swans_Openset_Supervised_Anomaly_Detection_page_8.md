Page 8

The detection performance on six datasets applicable under the hard setting is presented in Tab. 2.

Application Domain Perspective . In both one-shot and ten-shot settings of the diverse application datasets, compared to the competing methods, our method is the best performer on most of the individual data subsets; at the datasetlevel performance, our model achieves about 2%-10% mean AUC increase compared to the best contender on most of the six datasets, with close to the best performance on the other datasets. This shows substantially better generalizability of our model in detecting unseen anomaly classes than the other supervised detectors.

Sample Efficiency . Compared to one-shot scenarios to the ten-shot ones, our model, on average, has 5.5% AUC decrease at the dataset level, which is better than that of the competing methods: DevNet (9.8%), FLOS (7.1%), SAOE (7.8%), and MLEP (10%). More impressively, our model trained with one anomaly example outperforms the ten-shot competing models by a large margin on many of the individual data subsets as well as the overall datasets.

Comparison to Unsupervised Baseline . Current supervised AD models are often biased towards the seen anomaly

Table 2. AUC results under the hard setting, where models are trained with one known anomaly class and tested to detect the rest of all other anomaly classes. Each data subset is named by the known anomaly class.

|           | Data Subset                 | Baseline    | One Training Anomaly Example   | One Training Anomaly Example   | One Training Anomaly Example   | One Training Anomaly Example   | One Training Anomaly Example   | Ten Training Anomaly Examples   | Ten Training Anomaly Examples   | Ten Training Anomaly Examples   | Ten Training Anomaly Examples   | Ten Training Anomaly Examples   |
|-----------|-----------------------------|-------------|--------------------------------|--------------------------------|--------------------------------|--------------------------------|--------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|---------------------------------|
| Dataset   |                             | KDAD        | DevNet                         | FLOS                           | SAOE                           | MLEP                           | DRA (Ours)                     | DevNet                          | FLOS                            | SAOE                            | MLEP                            | DRA (Ours)                      |
|           | Color                       | 0.787±0.005 | 0.716±0.085                    | 0.467±0.278                    | 0.763 ±0.100                   | 0.547±0.056                    | 0.879 ±0.021                   | 0.767 ±0.015                    | 0.760±0.005                     | 0.467±0.067                     | 0.698±0.025                     | 0.886 ±0.042                    |
|           | Cut                         | 0.766±0.005 | 0.666±0.035                    | 0.685 ±0.007                   | 0.664±0.165                    | 0.658±0.056                    | 0.902 ±0.033                   | 0.819 ±0.037                    | 0.688±0.059                     | 0.793±0.175                     | 0.653±0.120                     | 0.922 ±0.038                    |
|           | Hole                        | 0.757±0.003 | 0.721±0.067                    | 0.594±0.142                    | 0.772 ±0.071                   | 0.653±0.065                    | 0.901 ±0.033                   | 0.814±0.038                     | 0.733±0.014                     | 0.831 ±0.125                    | 0.674±0.076                     | 0.947 ±0.016                    |
| Carpet    | Metal                       | 0.836±0.003 | 0.819 ±0.032                   | 0.701±0.028                    | 0.780±0.172                    | 0.706±0.047                    | 0.871 ±0.037                   | 0.863±0.022                     | 0.678±0.083                     | 0.883 ±0.043                    | 0.764±0.061                     | 0.933 ±0.022                    |
|           | Thread                      | 0.750±0.005 | 0.912±0.044                    | 0.941 ±0.005                   | 0.787±0.204                    | 0.831±0.117                    | 0.950 ±0.029                   | 0.972 ±0.009                    | 0.946±0.005                     | 0.834±0.297                     | 0.967±0.006                     | 0.989 ±0.004                    |
|           | Mean                        | 0.779±0.002 | 0.767 ±0.018                   | 0.678±0.040                    | 0.753±0.055                    | 0.679±0.029                    | 0.901 ±0.006                   | 0.847 ±0.017                    | 0.761±0.012                     | 0.762±0.073                     | 0.751±0.023                     | 0.935 ±0.013                    |
|           | Bent                        | 0.798±0.015 | 0.797±0.048                    | 0.851±0.046                    | 0.864 ±0.032                   | 0.743±0.013                    | 0.952 ±0.020                   | 0.904±0.022                     | 0.827±0.075                     | 0.901±0.023                     | 0.956 ±0.013                    | 0.990 ±0.003                    |
| Metal nut | Color                       | 0.754±0.014 | 0.909 ±0.023                   | 0.821±0.059                    | 0.857±0.037                    | 0.835±0.075                    | 0.946 ±0.023                   | 0.978 ±0.016                    | 0.978 ±0.008                    | 0.879±0.018                     | 0.945±0.039                     | 0.967 ±0.011                    |
| Metal nut | Flip                        | 0.646±0.019 | 0.764±0.014                    | 0.799±0.058                    | 0.751±0.090                    | 0.813 ±0.031                   | 0.921 ±0.029                   | 0.987 ±0.004                    | 0.942 ±0.009                    | 0.795±0.062                     | 0.805±0.057                     | 0.913±0.021                     |
| Metal nut | Scratch                     | 0.737±0.010 | 0.952 ±0.052                   | 0.947±0.027                    | 0.792±0.075                    | 0.907±0.085                    | 0.909 ±0.023                   | 0.991 ±0.017                    | 0.943 ±0.002                    | 0.845±0.041                     | 0.805±0.153                     | 0.911±0.034                     |
| Metal nut | Mean                        | 0.734±0.005 | 0.855 ±0.016                   | 0.855 ±0.024                   | 0.816±0.029                    | 0.825±0.023                    |                                | 0.965 ±0.011                    | 0.922±0.014                     | 0.855±0.016                     | 0.878±0.058                     | 0.945 ±0.017                    |
| AITEX     | Broken end                  | 0.552±0.006 | 0.712 ±0.069                   | 0.645±0.030                    | 0.778 ±0.068                   | 0.441±0.111                    | 0.932 ±0.017 0.708±0.094       | 0.658±0.111                     | 0.585±0.037                     | 0.712 ±0.068                    | 0.732 ±0.065                    | 0.693±0.099                     |
| AITEX     | Broken pick                 | 0.705±0.003 | 0.552±0.003                    | 0.598±0.023                    | 0.644 ±0.039                   | 0.476±0.070                    | 0.731 ±0.072                   | 0.585±0.028                     | 0.548±0.054                     | 0.629 ±0.012                    | 0.555±0.027                     | 0.760 ±0.037                    |
| AITEX     | Cut selvage                 | 0.567±0.006 | 0.689±0.016                    | 0.694 ±0.036                   | 0.681±0.077                    | 0.434±0.149                    | 0.739 ±0.101                   | 0.709±0.039                     | 0.745±0.035                     | 0.770 ±0.014                    | 0.682±0.025                     | 0.777 ±0.036                    |
| AITEX     | Fuzzyball                   | 0.559±0.008 | 0.617 ±0.075                   | 0.525±0.043                    | 0.650 ±0.064                   | 0.525±0.157                    | 0.538±0.092                    | 0.734 ±0.039                    | 0.550±0.082                     | 0.842 ±0.026                    | 0.677±0.223                     | 0.701±0.093                     |
| AITEX     | Nep                         | 0.566±0.006 | 0.722 ±0.023                   | 0.734 ±0.038                   | 0.710±0.044                    | 0.517±0.059                    | 0.717±0.052                    | 0.810 ±0.042                    | 0.746±0.060                     | 0.771 ±0.032                    | 0.740±0.052                     | 0.750±0.038                     |
| AITEX     | Weft crack                  | 0.529±0.006 | 0.586 ±0.134                   | 0.546±0.114                    | 0.582±0.108                    | 0.400±0.029                    | 0.669 ±0.045                   | 0.599±0.137                     | 0.636 ±0.051                    | 0.618±0.172                     | 0.370±0.037                     | 0.717 ±0.072                    |
| AITEX     | Mean                        | 0.580±0.004 | 0.646±0.034                    | 0.624±0.024                    | 0.674 ±0.034                   | 0.466±0.030                    | 0.684 ±0.033                   | 0.683±0.032                     | 0.635±0.043                     | 0.724 ±0.032                    | 0.626±0.041                     | 0.733 ±0.009                    |
| ELPV      | Mono                        | 0.796±0.002 | 0.634±0.087                    | 0.717 ±0.025                   | 0.563±0.102                    | 0.649±0.027                    | 0.735 ±0.031                   | 0.599±0.040                     | 0.629±0.072                     | 0.569±0.035                     | 0.756 ±0.045                    | 0.731 ±0.021                    |
| ELPV      | Poly                        | 0.679±0.004 | 0.662±0.050                    | 0.665 ±0.021                   | 0.665 ±0.173                   | 0.483±0.247                    | 0.671 ±0.051                   | 0.804 ±0.022                    | 0.662±0.042                     | 0.796±0.084                     | 0.734±0.078                     | 0.800 ±0.064                    |
| ELPV      | Mean                        | 0.737±0.002 | 0.648±0.057                    | 0.691 ±0.008                   | 0.614±0.048                    | 0.566±0.111                    | 0.703 ±0.022                   | 0.702±0.023                     | 0.646±0.032                     | 0.683±0.047                     | 0.745 ±0.020                    | 0.766 ±0.029                    |
| Mastcam   | Bedrock                     | 0.638±0.007 | 0.495±0.028                    | 0.499±0.056                    | 0.636 ±0.072                   | 0.532±0.036                    | 0.668 ±0.012                   | 0.550±0.053                     | 0.499±0.098                     | 0.636 ±0.068                    | 0.512±0.062                     | 0.658 ±0.021                    |
| Mastcam   | Broken-rock                 | 0.590±0.007 | 0.533±0.020                    | 0.569±0.025                    | 0.699 ±0.058                   | 0.544±0.088                    | 0.645 ±0.053                   | 0.547±0.018                     | 0.608±0.085                     | 0.712 ±0.052                    | 0.651±0.063                     | 0.649 ±0.047                    |
| Mastcam   | Drill-hole                  | 0.630±0.006 | 0.555±0.037                    | 0.539±0.077                    | 0.697 ±0.074                   | 0.636±0.066                    | 0.657 ±0.070                   | 0.583±0.022                     | 0.601±0.009                     | 0.682 ±0.042                    | 0.660±0.002                     | 0.725 ±0.005                    |
| Mastcam   | Drt                         | 0.711±0.005 | 0.529±0.046                    | 0.591±0.042                    | 0.735 ±0.020                   | 0.624±0.042                    | 0.713 ±0.053                   | 0.621±0.043                     | 0.652±0.024                     | 0.761 ±0.062                    | 0.616±0.048                     | 0.760 ±0.033                    |
| Mastcam   | Dump-pile                   | 0.697±0.007 | 0.521±0.020                    | 0.508±0.021                    | 0.682 ±0.022                   | 0.545±0.127                    | 0.767 ±0.043                   | 0.705±0.011                     | 0.700±0.070                     | 0.750 ±0.037                    | 0.696±0.047                     | 0.748 ±0.066                    |
| Mastcam   | Float                       | 0.632±0.007 | 0.502±0.020                    | 0.551±0.030                    | 0.711 ±0.041                   | 0.530±0.075                    | 0.670 ±0.065                   | 0.615±0.052                     | 0.736 ±0.041                    | 0.718±0.064                     | 0.671±0.032                     | 0.744 ±0.073                    |
| Mastcam   | Meteorite                   | 0.634±0.007 | 0.467±0.049                    | 0.462±0.077                    | 0.669 ±0.037                   | 0.476±0.014                    | 0.637 ±0.015                   | 0.554±0.021                     | 0.568±0.053                     | 0.647 ±0.030                    | 0.473±0.047                     | 0.716 ±0.004                    |
| Mastcam   | Scuff                       | 0.638±0.006 | 0.472±0.031                    |                                |                                |                                | 0.549 ±0.027                   | 0.528±0.034                     | 0.575±0.042                     | 0.676 ±0.019                    | 0.504±0.052                     | 0.636 ±0.086                    |
| Mastcam   | Veins                       | 0.621±0.007 | 0.527±0.023                    | 0.508±0.070 0.493±0.052        | 0.679 ±0.048 0.688 ±0.069      | 0.492±0.037 0.489±0.028        | 0.699 ±0.045                   | 0.589±0.072                     | 0.608±0.044                     | 0.686 ±0.053                    | 0.510±0.090                     | 0.620 ±0.036                    |
| Mastcam   |                             | 0.644±0.003 | 0.511±0.013                    | 0.524±0.013                    | 0.689 ±0.037                   | 0.541±0.007                    | 0.667 ±0.012                   | 0.588±0.011                     | 0.616±0.021                     | 0.697 ±0.014                    | 0.588±0.016                     | 0.695 ±0.004                    |
| Mastcam   | Mean                        | 0.405±0.003 | 0.672±0.014                    | 0.703 ±0.040                   | 0.382±0.117                    | 0.438±0.111                    | 0.772 ±0.019                   | 0.834 ±0.012                    | 0.764±0.066                     | 0.698±0.037                     | 0.540±0.014                     | 0.824 ±0.006                    |
| Mastcam   | Barretts Barretts-short-seg | 0.404±0.003 | 0.604 ±0.048                   | 0.538±0.033                    | 0.367±0.050                    | 0.532±0.075                    | 0.674 ±0.018                   | 0.799±0.036                     | 0.810 ±0.034                    | 0.661±0.034                     | 0.480±0.107                     | 0.835 ±0.021                    |
| Mastcam   | Hyper-Kvasir Esophagitis-a  | 0.435±0.002 | 0.569 ±0.051                   | 0.536±0.040                    | 0.518±0.063                    | 0.491±0.084                    | 0.778 ±0.020                   | 0.844 ±0.014                    | 0.815±0.022                     | 0.820±0.034                     | 0.646±0.036                     | 0.881 ±0.035                    |
| Mastcam   | Esophagitis-b-d             | 0.367±0.003 | 0.536 ±0.033                   | 0.505±0.039                    | 0.358±0.039                    | 0.457±0.086                    | 0.577 ±0.025                   | 0.810 ±0.015                    | 0.754±0.073                     | 0.611±0.017                     | 0.621±0.042                     | 0.837 ±0.009                    |
| Mastcam   |                             |             | 0.595                          | 0.571±0.004                    |                                |                                | 0.700                          |                                 | 0.786±0.021                     | 0.698±0.021                     |                                 | 0.844                           |
| Mastcam   | Mean                        | 0.403±0.001 | ±0.023                         |                                | 0.406±0.01 8                   | 0.480±0.044                    | ±0.009                         | 0.822 ±0.019                    |                                 |                                 | 0.571±0.014                     | ±0.009                          |

class and fail to generalize to unseen anomaly classes, performing less effective than the unsupervised baseline KDAD on most of the datasets. By contrast, our model has significantly improved generalizability and largely outperforms KDAD even under the one-shot scenarios. This generalizability is further supported by our preliminary results in cross-domain anomaly detection in Appendix C.3 .

## 4.5. Ablation Study

Importance of Each Abnormality Learning . Tab. 3 shows the results of each abnormality learning in DRA using ten training anomaly examples.

DRA1A is the variant of DRA that only learns the known abnormality using the seen anomalies. It performs comparably well to the two best contenders, DevNet and SAOE, but limiting to the known abnormality leads to less effective results than the other variants, especially on the hard setting.

DRA2A builds upon DRA1A with the addition of pseudo abnormality learning. Compared with DRA1A, the inclusion of the pseudo abnormality largely improves the performance on most datasets. On some datasets, such as Hyper-Kvasir on the hard setting, the performance of DRA2A drops, which may be due to the discrepancy between the pseudo and real anomalies.