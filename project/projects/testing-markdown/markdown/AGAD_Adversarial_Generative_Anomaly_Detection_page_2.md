Page 2

As surveys Pang et al. (2021); Rani and E (2020) indicated, semi-supervised anomaly detection methods dominated in this research field. Recently, with the introduction of GANs Goodfellow et al. (2014), many researches attempted to bring GANs into anomaly detection. Earlier works like AnoGAN Schlegl, SeebÃ¶ck, Waldstein, SchmidtErfurth and Langs (2017a) learns the normal data distributions with GANs and attempts to reconstruct the most similar images by optimizing a latent noise vector iteratively. With the success of Adversarial Auto Encoders (AAE) Makhzani, Shlens, Jaitly, Goodfellow and Frey (2016), some more recent works combined AutoEncoders and GANs together to detect anomalies. Particularly, GANomaly Akcay et al. (2019a) further regularized the latent spaces between inputs and reconstructed images, then some following works improved it with more advanced generators like UNet Akcay et al. (2019b) and UNet++ Cheng, Liu, Gao and Chen (2020). Most of those works attempted to achieve better anomaly detection performances by learning towards the better reconstruction of normalities, disregarding the awareness of abnormalities.

In contrast, supervised anomaly detection methods take both normal and abnormal data into account. Notably, supervised anomaly detection was mostly formulated as an imbalanced classification problem that addressed with different classification approaches Agrawal and Agrawal (2015) or sampling strategies Mishra (2017); Gonzalez, Dasgupta and Kozma (2002). However, supervised anomaly detection is normally in course of little labelled or noisy labelled data with limited supervisions. In such sense, Deep SAD Ruff, Vandermeulen, GÃ¶rnitz, Binder, MÃ¼ller, MÃ¼ller and Kloft (2020), a general method based on Deep SVDDRuffet al. (2018), proposed a two-stage training with information-theoretic framework. TLSAD Feng, Tang, Dou and Wu (2021) further consolidated the model's discriminative power with a transfer learning framework, which relied on an additional large-scale reference dataset for the model training. Recent advances Razakarivony and Jurie

(2014); LÃ¼bbering, Ramamurthy, Gebauer, Bell, Sifa and Bauckhage (2020); Yamanaka, Iwata, Takahashi, Yamada and Kanai (2019) took the advantage of reconstructionbased anomaly detection framework and proposed different methods to address the unbalanced classification problem by minimizing the reconstruction error for normal data, and to maximizing it for anomalies. ESAD Huang, Ye, Zhang, Wang and Tian (2021) considers both ideas of information-theoretic framework and reconstruction-based anomaly detection framework to optimize mutual information and entropy. Due to the limited availability of anomaly samples, a major challenge of supervised anomaly detection is to improve the data-efficiency of learning algorithms.

With the successes of supervised deep learning models, more researches Dosovitskiy, Springenberg, Riedmiller and Brox (2014); Wen, Zhang, Li and Qiao (2016) explored the methods of reducing the needs of labelled samples, as known as discriminative feature learning. Learning discriminative features has also proven to be effective in anomaly detection field, GeoTrans Golan and El-Yaniv (2018) leveraged geometric transformations to learn discriminative features. ARNet Ye et al. (2022) attempted to use embedding-guided feature restoration to learn more semantic anomaly features. Recently, self-supervised representation learning is getting more attention since it learns domain-specific discriminative features for downstream tasks without any labelling efforts. Specifically, contrastive learning methods Chen et al. (2020a,b); He et al. (2019); Chen et al. (2020c); Grill et al. (2020); Chen and He (2021); Caron et al. (2020) has proven to be one of the most promising approaches in unsupervised representation learning. With the recent works of the integration Tack, Mo, Jeong and Shin (2020); Cho, Seol and goo Lee (2021) of contrastive learning and anomaly detection tasks, we tended to further combine it with GANs to explore discriminative anomaly features unsupervisedly.

## 3. Proposed Method: AGAD

This section will elaborate the main methodology of our proposed AGAD method. We firstly presented an overview of the problem and our solution, then provided a detailed introduction of the training objectives, along with the training algorithm. Lastly, we compared our method with other relative algorithms.

## 3.1. Method Overview

Whilst training with normality data î‰„ ğ‘› , the aforementioned routine process learns to reconstruct î‰„ ğ‘› to Ì‚ î‰„ ğ‘› with

Given an anomaly detection dataset î‰„ with normality î‰„ ğ‘› and abnormality î‰„ ğ‘ , whereas î‰„ ğ‘› = { ğ‘¥ ğ‘› âˆ¶ ğ‘¥ ğ‘› âˆ¼ ğ‘ ğ‘› ( ğ‘¥ )} and î‰„ ğ‘ = { ğ‘¥ ğ‘ âˆ¶ ğ‘¥ ğ‘ âˆ¼ ğ‘ ğ‘ ( ğ‘¥ )} . To distinguish î‰„ ğ‘› and î‰„ ğ‘ , we utilized a GAN-like structure with a generator ğº to reconstruct image data î‰„ into reconstructed data space Ì‚ î‰„ , and a discriminator ğ· is used to distinguish between data domains of î‰„ and Ì‚ î‰„ . Generally, ğº tends to generate realistic Ì‚ î‰„ that is indistinguishable to î‰„ to fool ğ· . Notably, ğ· also acts as a feature extractor to compress image data î‰„ into latent spaces î‰† , denoted as ğ· î‰† .

Figure 1: The proposed AGAD architecture. (a) training pipeline for normal data: that brings anomaly-awareness by minimizing the contextual loss ğ¿ ğ‘ğ‘œğ‘› and maximize the contextual adversarial loss ğ¿ ğ‘ğ‘‘ğ‘ğ‘œğ‘› . (b) training pipeline for abnormal data: learns to fail the reconstruction of anomaly directly.

<!-- image -->

minimum differences. Next, anomaly-awareness is achieved by the contextual adversarial information . Specifically, we assume the reconstructed Ì‚ î‰„ as pseudo-anomaly and expect the reconstruction of Ì‚ î‰„ will be failed. Mathematically, given a distance function îˆ² ğ‘‘ğ‘–ğ‘ ğ‘¡ , we expect to learn a suite of parameter ğœƒ ğº and ğœƒ ğ· that can achieve:

min îˆ² ğ‘‘ğ‘–ğ‘ ğ‘¡ ( î‰„ ğ‘› , Ì‚ î‰„ ğ‘› ; ğœƒ ğº ) âˆ§ max îˆ² ğ‘‘ğ‘–ğ‘ ğ‘¡ ( Ì‚ î‰„ ğ‘› , ğº ( Ì‚ î‰„ ğ‘› ); ğœƒ ğº ) , (1)

min ğº max ğ· [log ğ· ( î‰„ ğ‘› ; ğœƒ ğ· )+log (1 ğ· ( ğº ( î‰„ ğ‘› ; ğœƒ ğº ); ğœƒ ğ· )] . (2)

Whenabnormaldata î‰„ ğ‘ available, the generator ğº learns to fail the reconstruction directly and the discriminator ğ· can distinguish it from the normal: