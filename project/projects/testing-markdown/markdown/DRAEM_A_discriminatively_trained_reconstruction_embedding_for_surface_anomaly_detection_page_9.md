Page 9

Table 3. Surface anomaly detection (Det.) and localization (Loc.) experiments of the ablation study grouped by shades of gray into (i) method architecture, (ii) anomaly source dataset, (iii) hard simulated anomaly generation, (iv) simulated anomaly shape, and (v) the performance of DRÆM for reference.

|                     | Architecture   | Architecture   |              | Anomaly Generation   | Anomaly Generation   | Anomaly Generation   | Anomaly Generation   |              | Results   | Results     |
|---------------------|----------------|----------------|--------------|----------------------|----------------------|----------------------|----------------------|--------------|-----------|-------------|
| Method              | Recon. Net.    | Discr. Net.    | Augmentation | β                    | ImageNet             | DTD                  | Perlin               | Rectangle    | Det.      | Loc.        |
| Disc.               |                | glyph[check]   | glyph[check] | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 93.9      | 92.7 / 62.5 |
| Recon.-AE           | glyph[check]   |                | glyph[check] | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 83.9      | 89.7 / 47.5 |
| Recon.-AE MSGMS     | glyph[check]   |                | glyph[check] | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 90.7      | 93.4 / 50.9 |
| Boˇziˇc et al . [6] |                |                | glyph[check] | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 92.8      | 93.9 / 60.7 |
| DRÆM ImageNet       | glyph[check]   | glyph[check]   | glyph[check] | glyph[check]         | glyph[check]         |                      | glyph[check]         |              | 97.9      | 97.0 / 67.9 |
| DRÆM color          | glyph[check]   | glyph[check]   |              | glyph[check]         |                      |                      | glyph[check]         |              | 96.2      | 92.6 / 56.5 |
| DRÆM rect           | glyph[check]   | glyph[check]   | glyph[check] | glyph[check]         |                      | glyph[check]         |                      | glyph[check] | 96.9      | 96.8 / 65.1 |
| DRÆM no aug         | glyph[check]   | glyph[check]   |              |                      |                      | glyph[check]         | glyph[check]         |              | 97.4      | 94.5 / 64.3 |
| DRÆM img aug        | glyph[check]   | glyph[check]   | glyph[check] |                      |                      | glyph[check]         | glyph[check]         |              | 97.4      | 95.0 / 64.5 |
| DRÆM β              | glyph[check]   | glyph[check]   |              | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 97.9      | 97.1 / 68.4 |
| DRÆM                | glyph[check]   | glyph[check]   | glyph[check] | glyph[check]         |                      | glyph[check]         | glyph[check]         |              | 98.0      | 97.3 / 68.4 |

generated as homogeneous regions of a randomly sampled color (DRÆM color ). Note that DRÆM color still achieves state-of-the-art results, further suggesting that DRÆM does not require simulations to closely match the real anomalies.

The impact of the anomaly shape generator is evaluated by replacing the Perlin noise generator by a rectangular region generator. The anomaly mask is thus generated by sampling multiple rectangular areas for the anomalous regions (DRÆM rect in Table 3). Training on rectangular anomalies causes only a slight performance drop and suggests that the simulated anomaly shape does not have to be realistic to generalize well to real world anomalies. Examples of anomalies generated in anomaly appearance ablation experiments are shown in Figure 10.

Low perturbation examples. The anomaly source image augmentation and the opacity randomization are re-

sponsible for tightening the decision boundary around the anomaly-free training distribution. Table 3 reports the results of DRÆM variants trained (i) without image augmentation and opacity randomization (DRÆM no aug ), (ii) using only image augmentation (DRÆM img aug ) and (iii) using only opacity randomization (DRÆM β ). There is a significant localization performance gap between DRÆM no aug and DRÆM, however, this can be significantly narrowed by using the opacity randomization in training even without image data augmentation.

## 4.3. Comparison with supervised methods

Supervised methods require anomaly annotations at training time and cannot be evaluated on MVTec. We thus compare DRÆM with the supervised methods on the DAGM dataset [28] that contains 10 textured object classes

Figure 9. DRÆM achieves a remarkable detection and localization performance already at as low as 10 texture source images in the simulator when augmentation is applied.

<!-- image -->

Figure 10. Anomalies simulated using the DTD [9] (DRÆM), ImageNet [12] (DRÆM ImageNet ), homogeneous color regions (DRÆM color ) and rectangular masks (DRÆM rect ), from left to right.