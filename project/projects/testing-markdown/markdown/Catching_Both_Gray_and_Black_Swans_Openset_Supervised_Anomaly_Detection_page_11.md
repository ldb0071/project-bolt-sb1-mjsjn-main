Page 11

- anomaly detection. In Proc. IEEE Int. Conf. Comp. Vis. , pages 1705-1714, 2019. 1, 2
- [14] Nico Gornitz, Marius Kloft, Konrad Rieck, and Ulf Brefeld. Toward supervised anomaly detection. J. Artificial Intelligence Research , 46:235-262, 2013. 2
- [15] R. Hadsell, S. Chopra, and Y. LeCun. Dimensionality reduction by learning an invariant mapping. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , volume 2, pages 1735-1742, 2006. 14
- [16] Haibo He and Edwardo A Garcia. Learning from imbalanced data. IEEE T. Knowledge and Data Engineering , 21(9):1263-1284, 2009. 2
- [17] Dan Hendrycks and Kevin Gimpel. A baseline for detecting misclassified and out-of-distribution examples in neural networks. In Proc. Int. Conf. Learn. Representations , 2017. 2
- [18] Dan Hendrycks, Mantas Mazeika, and Thomas Dietterich. Deep anomaly detection with outlier exposure. In Proc. Int. Conf. Learn. Representations , 2019. 2, 3, 4, 5, 7, 14
- [19] Jinlei Hou, Yingying Zhang, Qiaoyong Zhong, Di Xie, Shiliang Pu, and Hong Zhou. Divide-and-assemble: Learning block-wise memory for unsupervised anomaly detection. In Proc. IEEE Int. Conf. Comp. Vis. , pages 8791-8800, October 2021. 2, 5
- [20] Rui Huang and Yixuan Li. Mos: Towards scaling out-ofdistribution detection for large semantic space. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 8710-8719, 2021. 2, 3
- [21] Radu Tudor Ionescu, Sorina Smeureanu, Bogdan Alexe, and Marius Popescu. Unmasking the abnormal events in video. In Proc. IEEE Int. Conf. Comp. Vis. , pages 2895-2903, 2017. 1
- [22] Hannah R Kerner, Kiri L Wagstaff, Brian D Bue, Danika F Wellington, Samantha Jacob, Paul Horton, James F Bell, Chiman Kwan, and Heni Ben Amor. Comparison of novelty detection methods for multispectral images in rover-based planetary exploration missions. Data Mining and Knowledge Discovery , 34(6):1642-1675, 2020. 5, 12
- [23] Nima Khakzad, Faisal Khan, and Paul Amyotte. Major accidents (gray swans) likelihood modeling using accident precursors and approximate reasoning. Risk analysis , 35(7):1336-1347, 2015. 2
- [24] Alex Krizhevsky, Geoffrey Hinton, et al. Learning multiple layers of features from tiny images. 2009. 5
- [25] Yann LeCun, L'eon Bottou, Yoshua Bengio, and Patrick Haffner. Gradient-based learning applied to document recognition. Proceedings of the IEEE , 86(11):2278-2324, 1998. 5
- [26] Chun-Liang Li, Kihyuk Sohn, Jinsung Yoon, and Tomas Pfister. Cutpaste: Self-supervised learning for anomaly detection and localization. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 9664-9674, 2021. 2, 4, 5, 7, 14
- [27] Liu Li, Mai Xu, Xiaofei Wang, Lai Jiang, and Hanruo Liu. Attention based glaucoma detection: A large-scale database and cnn model. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , June 2019. 5, 8, 14
- [28] Tsung-Yi Lin, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Doll'ar. Focal loss for dense object detection. In Proc. IEEE Int. Conf. Comp. Vis. , pages 2980-2988, 2017. 5, 14
- [29] Ziqian Lin, Sreya Dutta Roy, and Yixuan Li. Mood: Multilevel out-of-distribution detection. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 15313-15323, June 2021. 2
- [30] Wen Liu, Weixin Luo, Zhengxin Li, Peilin Zhao, Shenghua Gao, et al. Margin learning embedded prediction for video anomaly detection with a few anomalies. In Proc. Int. Joint Conf. Artificial Intell. , pages 3023-3030, 2019. 1, 2, 5, 14
- [31] Ziwei Liu, Zhongqi Miao, Xiaohang Zhan, Jiayun Wang, Boqing Gong, and Stella X Yu. Large-scale long-tailed recognition in an open world. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 2537-2546, 2019. 2
- [32] Philipp Liznerski, Lukas Ruff, Robert A. Vandermeulen, Billy Joe Franks, Marius Kloft, and Klaus-Robert Muller. Explainable deep one-class classification. In Proc. Int. Conf. Learn. Representations , 2021. 5
- [33] Amir Markovitz, Gilad Sharir, Itamar Friedman, Lihi ZelnikManor, and Shai Avidan. Graph embedded pose clustering for anomaly detection. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , June 2020. 1
- [34] Guansong Pang, Longbing Cao, Ling Chen, and Huan Liu. Learning representations of ultrahigh-dimensional data for random distance-based outlier detection. In Proc. ACM SIGKDD Int. Conf. Knowledge Discovery & Data Mining , pages 2041-2050, 2018. 2
- [35] Guansong Pang, Choubo Ding, Chunhua Shen, and Anton van den Hengel. Explainable deep few-shot anomaly detection with deviation networks. arXiv preprint arXiv:2108.00462 , 2021. 1, 2, 3, 5, 14, 15
- [36] Guansong Pang, Chunhua Shen, Longbing Cao, and Anton Van Den Hengel. Deep learning for anomaly detection: A review. ACM Computing Surveys , 54(2):1-38, 2021. 1, 2
- [37] Guansong Pang, Chunhua Shen, and Anton van den Hengel. Deep anomaly detection with deviation networks. In Proc. ACMSIGKDDInt. Conf. Knowledge Discovery & Data Mining , pages 353-362, 2019. 1, 2, 5, 14
- [38] Guansong Pang, Anton van den Hengel, Chunhua Shen, and Longbing Cao. Toward deep supervised anomaly detection: Reinforcement learning from partially labeled anomaly data. In Proc. ACM SIGKDD Int. Conf. Knowledge Discovery & Data Mining , pages 1298-1308, 2021. 2
- [39] Hyunjong Park, Jongyoun Noh, and Bumsub Ham. Learning memory-guided normality for anomaly detection. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , June 2020. 1, 2
- [40] Pramuditha Perera, Ramesh Nallapati, and Bing Xiang. Ocgan: One-class novelty detection using gans with constrained latent representations. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , June 2019. 2
- [41] Pramuditha Perera and Vishal M Patel. Learning deep features for one-class classification. IEEE Transactions on Image Processing , 28(11):5450-5463, 2019. 2
- [42] Tal Reiss, Niv Cohen, Liron Bergman, and Yedid Hoshen. Panda: Adapting pretrained features for anomaly detection and segmentation. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 2806-2814, 2021. 1, 4, 5, 7

- [43] Jie Ren, Peter J Liu, Emily Fertig, Jasper Snoek, Ryan Poplin, Mark A DePristo, Joshua V Dillon, and Balaji Lakshminarayanan. Likelihood ratios for out-of-distribution detection. In Proc. Advances in Neural Inf. Process. Syst. , 2019. 2
- [44] Lukas Ruff, Robert Vandermeulen, Nico Goernitz, Lucas Deecke, Shoaib Ahmed Siddiqui, Alexander Binder, Emmanuel Muller, and Marius Kloft. Deep one-class classification. In Proc. Int. Conf. Mach. Learn. , pages 4393-4402, 2018. 1, 2, 14
- [45] Lukas Ruff, Robert A Vandermeulen, Nico Gornitz, Alexander Binder, Emmanuel Muller, Klaus-Robert Muller, and Marius Kloft. Deep semi-supervised anomaly detection. In Proc. Int. Conf. Learn. Representations , 2020. 1, 2, 5, 14
- [46] Mohammad Sabokrou, Mohammad Khalooei, Mahmood Fathy, and Ehsan Adeli. Adversarially learned one-class classifier for novelty detection. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 3379-3388, 2018. 1, 2
- [47] Mohammadreza Salehi, Niousha Sadjadi, Soroosh Baselizadeh, Mohammad Hossein Rohban, and Hamid R Rabiee. Multiresolution knowledge distillation for anomaly detection. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , 2021. 1, 5, 12, 14
- [48] Walter J Scheirer, Anderson de Rezende Rocha, Archana Sapkota, and Terrance E Boult. Toward open set recognition. IEEE Trans. Pattern Anal. Mach. Intell. , 35(7):1757-1772, 2012. 2
- [49] Thomas Schlegl, Philipp Seebock, Sebastian M Waldstein, Georg Langs, and Ursula Schmidt-Erfurth. f-anogan: Fast unsupervised anomaly detection with generative adversarial networks. Medical Image Analysis , 54:30-44, 2019. 1, 2
- [50] Javier Silvestre-Blanes, Teresa Albero Albero, Ignacio Miralles, Rub'en P'erez-Llorens, and Jorge Moreno. A public fabric database for defect detection methods and results. Autex Research Journal , 19(4):363-374, 2019. 5, 12
- [51] Kihyuk Sohn, Chun-Liang Li, Jinsung Yoon, Minho Jin, and Tomas Pfister. Learning and evaluating representations for deep one-class classification. In Proc. Int. Conf. Learn. Representations , 2021. 2
- [52] Waqas Sultani, Chen Chen, and Mubarak Shah. Real-world anomaly detection in surveillance videos. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 6479-6488, 2018. 1
- [53] Domen Tabernik, Samo ˇ Sela, Jure Skvarˇc, and Danijel Skoˇcaj. Segmentation-Based Deep-Learning Approach for Surface-Defect Detection. Journal of Intelligent Manufacturing , May 2019. 5, 12
- [54] Jihoon Tack, Sangwoo Mo, Jongheon Jeong, and Jinwoo Shin. Csi: Novelty detection via contrastive learning on distributionally shifted instances. Proc. Advances in Neural Inf. Process. Syst. , 33:11839-11852, 2020. 4, 5, 7, 14
- [55] Nassim Nicholas Taleb. The black swan: The impact of the highly improbable , volume 2. Random house, 2007. 2
- [56] Yu Tian, Yuyuan Liu, Guansong Pang, Fengbei Liu, Yuanhong Chen, and Gustavo Carneiro. Pixel-wise energy-biased abstention learning for anomaly segmentation on complex urban driving scenes. arXiv: Comp. Res. Repository , 2021.

1

- [57] Yu Tian, Guansong Pang, Fengbei Liu, Yuanhong Chen, Seon Ho Shin, Johan W Verjans, Rajvinder Singh, and Gustavo Carneiro. Constrained contrastive distribution learning for unsupervised anomaly detection and localisation in medical images. In Proc. Int. Conf. Medical Image Computing and Computer Assisted Intervention , pages 128-140. Springer, 2021. 1, 2
- [58] Shashanka Venkataramanan, Kuan-Chuan Peng, Rajat Vikram Singh, and Abhijit Mahalanobis. Attention guided anomaly localization in images. In Proc. Eur. Conf. Comp. Vis. , pages 485-503. Springer, 2020. 1
- [59] Peng Wang, Lingqiao Liu, Chunhua Shen, Zi Huang, Anton van den Hengel, and Heng Tao Shen. What's wrong with that object? identifying images of unusual objects by modelling the detection score distribution. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 1573-1581, 2016. 1
- [60] Shenzhi Wang, Liwei Wu, Lei Cui, and Yujun Shen. Glancing at the patch: Anomaly localization with global and local feature comparison. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 254-263, 2021. 1, 3
- [61] Siqi Wang, Yijie Zeng, Xinwang Liu, En Zhu, Jianping Yin, Chuanfu Xu, and Marius Kloft. Effective end-to-end unsupervised outlier detection via inlier priority of discriminative network. In Proc. Advances in Neural Inf. Process. Syst. , pages 5960-5973, 2019. 2
- [62] Xinggang Wang, Yongluan Yan, Peng Tang, Xiang Bai, and Wenyu Liu. Revisiting multiple instance neural networks. Pattern Recognition , 74:15-24, 2018. 5, 14
- [63] M Wieler and T Hahn. Weakly supervised learning for industrial optical inspection. In DAGM Symposium , 2007. 5, 12
- [64] Han Xiao, Kashif Rasul, and Roland Vollgraf. Fashionmnist: a novel image dataset for benchmarking machine learning algorithms, 2017. 5
- [65] Jihun Yi and Sungroh Yoon. Patch SVDD: Patch-level svdd for anomaly detection and segmentation. In Proc. Asian Conf. Comp. Vis. , 2020. 3, 5
- [66] Zhongqi Yue, Tan Wang, Qianru Sun, Xian-Sheng Hua, and Hanwang Zhang. Counterfactual zero-shot and open-set visual recognition. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 15404-15414, June 2021. 2
- [67] Sangdoo Yun, Dongyoon Han, Seong Joon Oh, Sanghyuk Chun, Junsuk Choe, and Youngjoon Yoo. Cutmix: Regularization strategy to train strong classifiers with localizable features. In Proc. IEEE Int. Conf. Comp. Vis. , pages 60236032, 2019. 4, 5, 7
- [68] Alireza Zaeemzadeh, Niccolo Bisagno, Zeno Sambugaro, Nicola Conci, Nazanin Rahnavard, and Mubarak Shah. Outof-distribution detection using union of 1-dimensional subspaces. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 9452-9461, June 2021. 2
- [69] Muhammad Zaigham Zaheer, Jin-ha Lee, Marcella Astrid, and Seung-Ik Lee. Old is gold: Redefining the adversarially learned one-class classifier training paradigm. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 14183-14193, 2020. 1, 2
- [70] Muhammad Zaigham Zaheer, Arif Mahmood, Marcella Astrid, and Seung-Ik Lee. Claws: Clustering assisted weakly

- supervised learning with normalcy suppression for anomalous event detection. In Proc. Eur. Conf. Comp. Vis. , pages 358-376. Springer, 2020. 1
- [71] Jianpeng Zhang, Yutong Xie, Guansong Pang, Zhibin Liao, Johan Verjans, Wenxing Li, Zongji Sun, Jian He, Yi Li, Chunhua Shen, and Yong Xia. Viral pneumonia screening on chest x-rays using confidence-aware anomaly detection. IEEE T. Medical Imaging , 40(3):879-890, 2021. 1, 2
- [72] Chong Zhou and Randy C Paffenroth. Anomaly detection with robust deep autoencoders. In Proc. ACM SIGKDD Int. Conf. Knowledge Discovery & Data Mining , pages 665-674, 2017. 2
- [73] Da-Wei Zhou, Han-Jia Ye, and De-Chuan Zhan. Learning placeholders for open-set recognition. In Proc. IEEE Conf. Comp. Vis. Patt. Recogn. , pages 4401-4410, 2021. 2
- [74] Kang Zhou, Yuting Xiao, Jianlong Yang, Jun Cheng, Wen Liu, Weixin Luo, Zaiwang Gu, Jiang Liu, and Shenghua Gao. Encoding structure-texture relation with p-net for anomaly detection in retinal images. In Proc. Eur. Conf. Comp. Vis. , pages 360-377. Springer, 2020. 1, 2

## A. Dataset Details

## A.1. Key Statistics of Datasets

MVTecAD [3] is a popular defect inspection benchmark that has 15 different classes, with each anomaly class containing one to several subclasses. In total the dataset contains 73 defective classes of fine-grained anomaly classes at the texture- or object-level.

AITEX [50] is a fabrics defect inspection dataset that has 12 defect classes, with pixel-level defect annotation. We crop the original 4096 × 256 image to several 256 × 256 patch image and relabel each patch by pixel-wise annotation.

SDD [53] is a defect inspection dataset images of defective production items with pixel-level defect annotation. We vertically and equally divide the original 500 × 1250 image into three segment images and relabel each image by pixel-wise annotation.

ELPV [9] is a solar cells defect inspection dataset in electroluminescence imagery. It contains two defect classes depending on solar cells: mono- and poly-crystalline.